@model ProductDetailsModel
@using System;
@using Nop.Core;
@using Nop.Core.Domain.Customers;
@using Nop.Core.Infrastructure;
@using Nop.Services.Customers;
@using Nop.Web.Models.Catalog;
@using Nop.Web.Models.Customer;
@using Nop.Web.Controllers;
@using Nop.Web.Framework.Security;
@using Nop.Web.Models.Common;
@using System.Globalization
@inject Nop.Services.Customers.ICustomerService _customerService
@inject IWorkContext _workContext

<style>
    .product-collateral,
    .Berekening{
    padding: 0 20px;
}
</style>

 
    <br />
    <div class="Berekening">
        <b>@Model.Name</b>
    </div>
    <br /><br />
<div class="berekening pv saldering afbouw">
    @if (Model.Name == "Berekening PV saldering afbouw")
    {
        double KalekWhPrijs = 0;
        double kWhKostprijs = 0;
        double kWhopgewekt = 0;
        double pctTeruglevering = 0;
        double kWhterug = 0;
        double kWhvoltarief = 0;
        //double Jaar2020 = 0;
        double Jaar2021 = 0;
        double Jaar2022 = 0;
        double Jaar2023 = 0;
        double Jaar2024 = 0;
        double Jaar2025 = 0;
        double Jaar2026 = 0;
        double Jaar2027 = 0;
        double Jaar2028 = 0;
        double Jaar2029 = 0;
        double Jaar2030 = 0;
        double Jaar2031 = 0;
        double Jaar2032 = 0;
        //double cum2020 = 0;
        double cum2021 = 0;
        double cum2022 = 0;
        double cum2023 = 0;
        double cum2024 = 0;
        double cum2025 = 0;
        double cum2026 = 0;
        double cum2027 = 0;
        double cum2028 = 0;
        double cum2029 = 0;
        double cum2030 = 0;
        double cum2031 = 0;
        double cum2032 = 0;
       
    
        try
        {
            KalekWhPrijs = Convert.ToDouble(Model.Param1);
            kWhKostprijs = Convert.ToDouble(Model.Param2);
            kWhopgewekt = Convert.ToDouble(Model.Param3);
            pctTeruglevering = Convert.ToDouble(Model.Param4);
        }
        catch
        {
            <script>alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name733() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
        
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */

    var lineChartData = {
        labels: ["jan", "feb", "mar", "apr", "mei", "(c)", "Econo.nl", "aug", "sept", "oct", "nov", "dec"],
        datasets: [
            {
                label: "ORANJE - Opgewekte zonne-energie (bruto)",
                fillColor: "rgba(255,153,0,0.2)",
                strokeColor: "rgba(255,153,0,1)",
                pointColor: "rgba(255,153,0,1)",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(220,220,220,1)",
                data: [/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/],

            },
                {
                    label: "BLAUW - Benodigde energie voor tapwater capaciteitsprofiel /******/ Liter",
                    fillColor: "rgba(151,187,205,0.2)",
                    strokeColor: "rgba(151,187,205,1)",
                    pointColor: "rgba(151,187,205,1)",
                    pointStrokeColor: "#fff",
                    pointHighlightFill: "#fff",
                    pointHighlightStroke: "rgba(151,187,205,1)",
                    data: [/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/,/***/]
                },
                        {
                            label: "X-as = maand, Y-as=kWh"
                        }

        ]

    }

    var options = {
        responsive: true,
        legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><li><b>Grafieklijnen:</b></li><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].strokeColor%>\"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>"
        }


    window.onload = function () {
        var ctx = document.getElementById("canvas").getContext("2d");
        var linechart = new Chart(ctx).Line(lineChartData, options);

        document.getElementById('legendDiv').innerHTML = linechart.generateLegend();

        document.getElementById("Maximumstringvermogen").innerText = parseFloat("").toFixed(0);
    }
        
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name734() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


                function MakeUrl() {

                    var myurl = '/****************************************************/';

                    try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                    try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                    try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                    try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                    try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                    try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                    try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                    try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                    try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                    try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                    //alert(myurl);

                    window.location.assign(myurl);

                }
        
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name735() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
    
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name736() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
    
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name737() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
    
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name738() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
    
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name739() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
    
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name740() {
MakeUrlToInch()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name741() {
MakeUrlToMm()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


                function MakeUrlToInch() {

                    var myurl = '/****************************************************/';

                    try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                    try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                    try { myurl += "&Param3=Inch"; } catch (e) { }
                    try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                    try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                    try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                    try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                    try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                    try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                    try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                    //alert(myurl);

                    window.location.assign(myurl);

                }

                function MakeUrlToMm() {

                    var myurl = '/****************************************************/';

                    try { myurl += "?Param1=" + document.getElementById('Param1a').value; } catch (e) { }
                    try { myurl += "&Param2=" + document.getElementById('Param2a').value; } catch (e) { }
                    try { myurl += "&Param3=Mm"; } catch (e) { }
                    try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                    try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                    try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                    try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                    try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                    try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                    try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                    //alert(myurl);

                    window.location.assign(myurl);

                }

            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name742() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
    
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name743() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


                function MakeUrl() {

                    var myurl = '/****************************************************/';

                    try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                    try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                    try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                    try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                    try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                    try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                    try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                    try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                    try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                    try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                    //alert(myurl);

                    window.location.assign(myurl);

                }
            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name744() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


                function MakeUrl() {

                    var myurl = '/****************************************************/';

                    try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                    try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                    try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                    try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                    try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                    try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                    try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                    try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                    try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                    try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                    //alert(myurl);

                    window.location.assign(myurl);

                }
            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name745() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
        
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
function name746() {
MakeUrl()
}
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */


            function MakeUrl() {

                var myurl = '/****************************************************/';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
        
/* END EXTERNAL SOURCE */
/* BEGIN EXTERNAL SOURCE */
alert("gebruik een getal met een komma als decimaal scheidingsteken")            </script>
        }

        if (KalekWhPrijs == 0 && kWhKostprijs == 0 && kWhopgewekt == 0 && pctTeruglevering ==0) // demo waarden invullen
        {
            KalekWhPrijs = 0.07;
            kWhKostprijs = 0.22;
            kWhopgewekt = 2400;
            pctTeruglevering = 75;
            
        }


        //make calculation here
        
        kWhterug = pctTeruglevering / 100 * kWhopgewekt;
        kWhvoltarief = kWhopgewekt - kWhterug;
        //Jaar2020 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 0) * kWhterug;
        Jaar2021 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 0) * kWhterug;
        Jaar2022 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 0) * kWhterug;
        Jaar2023 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 1) * kWhterug;
        Jaar2024 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 2) * kWhterug;
        Jaar2025 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 3) * kWhterug;
        Jaar2026 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 4) * kWhterug;
        Jaar2027 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 5) * kWhterug;
        Jaar2028 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 6) * kWhterug;
        Jaar2029 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 7) * kWhterug;
        Jaar2030 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 8) * kWhterug;
        Jaar2031 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs)) * kWhterug;
        Jaar2032 = kWhvoltarief * kWhKostprijs + (kWhKostprijs - (@kWhKostprijs - @KalekWhPrijs)) * kWhterug;

        //cum2020 = Jaar2020;
        cum2021 = Jaar2021;  //+ cum2020;
        cum2022 = Jaar2022 + cum2021;
        cum2023 = Jaar2023 + cum2022;
        cum2024 = Jaar2024 + cum2023;
        cum2025 = Jaar2025 + cum2024;
        cum2026 = Jaar2026 + cum2025;
        cum2027 = Jaar2027 + cum2026;
        cum2028 = Jaar2028 + cum2027;
        cum2029 = Jaar2029 + cum2028;
        cum2030 = Jaar2030 + cum2029;
        cum2031 = Jaar2031 + cum2030;
        cum2032 = Jaar2032 + cum2031;
       

        this.Url.RouteUrl(this.ViewContext.RouteData.Values);


        <table>
            <tr style="font-weight:bold;"><td width="120">Naam</td><td width="80">Eenheid</td><td width="110">Waarde</td></tr>
            <tr><td>Kale kWh prijs</td><td>€</td><td><input id="Param1" value="@KalekWhPrijs" /></td></tr>
            <tr><td>kWh kostprijs</td><td>€</td><td><input id="Param2" value="@kWhKostprijs" /></td></tr>
            <tr><td>kWh met PV opgewekt</td><td>kWh</td><td><input id="Param3" value="@kWhopgewekt" /></td></tr>
            <tr><td>Percentage teruglevering</td><td>%</td><td><input id="Param4" value="@pctTeruglevering" /></td></tr>
        </table>
        
        <br/>
        
        <table>
            <tr style="font-weight:bold;">
                <td width="50"></td>
                <td width="80">Reductie</td>
                <td width="80">Opbrengst</td>
                <td width="80">Opbrengst</td>
                <td width="80">Opbrengst</td>
                <td width="80">start 2021</td>
                <td width="80">start 2022</td>

            </tr>
            <tr style="font-weight:bold;">
                <td>Jaar</td>
                <td>€/kWh</td>
                <td>voltarief</td>
                <td>ger. tarief</td>
                <td>Totaal</td>
                <td>cumulatief</td>
                <td>cumulatief</td>
            </tr>
             <tr>
                <td>2021</td>
                <td>Geen</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) / 8 * 0)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2021, 0)</td>
                <td>@Math.Round(@cum2021, 0)</td>
                <td>0</td>
            </tr>
            <tr>
                <td>2022</td>
                <td>Geen</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) / 8 * 0)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2022, 0)</td>
                <td>@Math.Round(@cum2022, 0)</td>
                <td>@Math.Round(@Jaar2022, 0)</td>

            </tr>


            <tr>
                <td>2023</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs)/100 *8 * 1, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 1)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2023, 0)</td>
                <td>@Math.Round(@cum2023, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023, 0)</td>
           </tr>
            <tr>
                <td>2024</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 2, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 *  8 * 2)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2024, 0)</td>
                <td>@Math.Round(@cum2024, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024, 0)</td>

            </tr>
            <tr>
                <td>2025</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 3, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 3)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2025, 0)</td>
                <td>@Math.Round(@cum2025, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025, 0)</td>

            </tr>
            <tr>
                <td>2026</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 4, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 4)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2026, 0)</td>
                <td>@Math.Round(@cum2026, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025 + @Jaar2026, 0)</td>
            </tr>
            <tr>
                <td>2027</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 5, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 5)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2027, 0)</td>
                <td>@Math.Round(@cum2027, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025 + @Jaar2026 + @Jaar2027, 0)</td>

            </tr>
            <tr>
                <td>2028</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 6, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 6)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2028, 0)</td>
                <td>@Math.Round(@cum2028, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025 + @Jaar2026 + @Jaar2027 + @Jaar2028, 0)</td>
            </tr>
            <tr>
                <td>2029</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 7, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 7)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2029, 0)</td>
                <td>@Math.Round(@cum2029, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025 + @Jaar2026 + @Jaar2027 + @Jaar2028 + @Jaar2029, 0)</td>

            </tr>
            <tr>
                <td>2030</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs) / 100 * 8 * 8, 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs) /100 * 8 * 8)) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2030, 0)</td>
                <td>@Math.Round(@cum2030, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025 + @Jaar2026 + @Jaar2027 + @Jaar2028 + @Jaar2029 + @Jaar2030, 0)</td>
          </tr>
            <tr>
                <td>2031</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs), 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs))) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2031, 0)</td>
                <td>@Math.Round(@cum2031, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025 + @Jaar2026 + @Jaar2027 + @Jaar2028 + @Jaar2029 + @Jaar2030 +  @Jaar2031, 0)</td>
            </tr>
            <tr>
                <td>2032</td>
                <td>@Math.Round((@kWhKostprijs - @KalekWhPrijs), 3)</td>
                <td>@Math.Round(@kWhvoltarief * @kWhKostprijs, 0)</td>
                <td>@Math.Round((@kWhKostprijs - ((@kWhKostprijs - @KalekWhPrijs))) * @kWhterug, 0)</td>
                <td>@Math.Round(@Jaar2032, 0)</td>
                <td>@Math.Round(@cum2032, 0)</td>
                <td>@Math.Round(@Jaar2022 + @Jaar2023 + @Jaar2024 + @Jaar2025 + @Jaar2026 + @Jaar2027 + @Jaar2028 + @Jaar2029 + @Jaar2030 + @Jaar2031 + @Jaar2032, 0)</td>
            </tr>
      </table>


        <input type="button" class="button-1" value="Opnieuw berekenen" onclick="MakeUrl()" />

        <br />
        <br />

        <script  asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

</div>

<div class="Berekening zonneboiler opbrengst en subsidie">
    @if (Model.Name == "Berekening zonneboiler opbrengst")
    {
        double Apertuuroppervlak = 0;
        double rendementbijT0 = 0;
        double Coefficient1 = 0;
        double Coefficient2 = 0;
        double IAM = 1;
        double a1 = 0;
        double a2 = 0;
        double Mdagen = 0;
        double Td = 0;
        double Zu = 0;
        double Wh = 0;
        double SolarRadiation = 0;
        double rendement = 0;
        double ColTemp = 40; // important value
        double verliezen = 0.9;
        double Ppump = 10;
        double Pstandby = 2;
        double Qaux = 1800 * Ppump / 1000 + (366 * 24 * Pstandby) / 1000;
        double Qnonsol = 0;
        double Qtota = 0;
        double Nwh = 0;
        double boilermaatuitcollector = 0;


        double QjaarBruto = 0;
        double Qjan = 12;
        double Qfeb = 15;
        double Qmar = 18;
        double Qapr = 20;
        double Qmei = 25;
        double Qjun = 30;
        double Qjul = 26;
        double Qaug = 21;
        double Qsep = 19;
        double Qoct = 16;
        double Qnov = 13;
        double Qdec = 11;

        double QjanNetto = 12;
        double QfebNetto = 15;
        double QmarNetto = 18;
        double QaprNetto = 20;
        double QmeiNetto = 25;
        double QjunNetto = 30;
        double QjulNetto = 26;
        double QaugNetto = 21;
        double QsepNetto = 19;
        double QoctNetto = 16;
        double QnovNetto = 13;
        double QdecNetto = 11;

        double janDekking = 0;
        double febDekking = 0;
        double marDekking = 0;
        double aprDekking = 0;
        double meiDekking = 0;
        double junDekking = 0;
        double julDekking = 0;
        double augDekking = 0;
        double sepDekking = 0;
        double octDekking = 0;
        double novDekking = 0;
        double decDekking = 0;


        short Helling = 0;

        double Qref = 0;
        double Pjaar = 21;
        double Pjan = 20;
        double Pfeb = 21;
        double Pmar = 21;
        double Papr = 20;
        double Pmei = 21;
        double Pjun = 20;
        double Pjul = 21;
        double Paug = 20;
        double Psep = 21;
        double Poct = 20;
        double Pnov = 21;
        double Pdec = 21;
        double GASPrijsM3 = 0;
        double kWhPrijs = 0;
        double OpbrengstElek = 0;
        double OpbrengstGas = 0;
        double Brend = 0;
        double Bverl = 0;
        double Bstby = 0;
        string Collector = "Prisma Pro";
        double collectoraantal = 18;
        int Profiel = 60; // liters/dag tapwater
        string[] CollectorChoices = { "Prisma Pro", "Kingspan Heatpipe", "Kingspan Direct Flow", "4Plus Vlakkeplaat", "2Plus Vlakkeplaat", "Ensol PVT", "Sunrain TZ58/1800", "TVP" };
        string[] AzimutChoices = { "O", "OZO", "ZO", "ZZO", "Z", "ZZW", "ZW", "WZW", "W" };
        double[] gemiddeldewatertemperatuur = { 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200 };
        string Azimut = AzimutChoices[4];


        Collector = Convert.ToString(Model.Param2);
        ColTemp = Convert.ToDouble(Model.Param7);
        Helling = Convert.ToInt16(Model.Param5);

        try
        {
            Profiel = Convert.ToInt16(Model.Param1);

        }

        catch
        {
            Profiel = 120;

        }

        if (Model.Param1 == null)
        {
            Profiel = 120;
        }

        try
        {
            collectoraantal = Convert.ToDouble(Model.Param8);

        }
        catch { collectoraantal = 18; }


        try
        {
            kWhPrijs = Convert.ToDouble(Model.Param3);

        }

        catch
        {
            kWhPrijs = .22;
        }

        try
        {
            GASPrijsM3 = Convert.ToDouble(Model.Param4);

        }
        catch
        {
            GASPrijsM3 = .71;
        }


        if (Model.Param8 == null)
        {
            collectoraantal = 18;
        }

        if (Model.Param5 == null)
        {
            Helling = 35;
        }

        if (Model.Param6 != null)
        {
            Azimut = Model.Param6;
        }

        try
        {

            ColTemp = Convert.ToDouble(Model.Param7);
            if (ColTemp < 10 || ColTemp > 210)
            {
                ColTemp = 40;
            }
        }
        catch { }


        if (Collector == "" || Collector == null)
        {
            Collector = CollectorChoices[0];
        }
        if (kWhPrijs == 0)
        {
            kWhPrijs = .22;
        }

        if (GASPrijsM3 == 0)
        {
            GASPrijsM3 = .71;
        }

        if (Helling < 0 || Helling > 90)
        {
            Helling = 35;
        }

        //make calculation here

        // get collector info

        int idx = Array.IndexOf(CollectorChoices, Collector);

        rendementbijT0 = GetCollectorInfo(idx + 1, 2);// first = 1 based array function
        Coefficient1 = GetCollectorInfo(idx + 1, 3);
        Coefficient2 = GetCollectorInfo(idx + 1, 4);
        Apertuuroppervlak = GetCollectorInfo(idx + 1, 5) * collectoraantal; //  bereken apertuur opp
        IAM = GetCollectorInfo(idx + 1, 11);

        // calc P[month], Pjaar

        Qref = GetCapacityInfo(Profiel); // bereken kwh voor tapwaterprofiel
        Pjan = Math.Round(Qref * GetMonthInfo(1, 2, Helling, Azimut), 0);
        Pfeb = Math.Round(Qref * GetMonthInfo(2, 2, Helling, Azimut), 0);
        Pmar = Math.Round(Qref * GetMonthInfo(3, 2, Helling, Azimut), 0);
        Papr = Math.Round(Qref * GetMonthInfo(4, 2, Helling, Azimut), 0);
        Pmei = Math.Round(Qref * GetMonthInfo(5, 2, Helling, Azimut), 0);
        Pjun = Math.Round(Qref * GetMonthInfo(6, 2, Helling, Azimut), 0);
        Pjul = Math.Round(Qref * GetMonthInfo(7, 2, Helling, Azimut), 0);
        Paug = Math.Round(Qref * GetMonthInfo(8, 2, Helling, Azimut), 0);
        Psep = Math.Round(Qref * GetMonthInfo(9, 2, Helling, Azimut), 0);
        Poct = Math.Round(Qref * GetMonthInfo(10, 2, Helling, Azimut), 0);
        Pnov = Math.Round(Qref * GetMonthInfo(11, 2, Helling, Azimut), 0);
        Pdec = Math.Round(Qref * GetMonthInfo(12, 2, Helling, Azimut), 0);
        Pjaar = Pjan + Pfeb + Pmar + Papr + Pmei + Pjun + Pjul + Paug + Psep + Poct + Pnov + Pdec;


        // calc Q[month], QjaarBruto
        Mdagen = GetMonthInfo(1, 2, Helling, Azimut); //Qjan
        Td = GetMonthInfo(1, 3, Helling, Azimut); // gem dagtemperatuur
        Zu = GetMonthInfo(1, 4, Helling, Azimut);// zonuren
        Wh = GetMonthInfo(1, 5, Helling, Azimut); // gem instraling op een dag
                                                  //SolarRadiation = Wh*24/Zu; / oude tabel
        SolarRadiation = Wh / Zu * 1.02; // nieuwe tabellen
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qjan = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qjan < 0) { Qjan = 0; }

        Mdagen = GetMonthInfo(2, 2, Helling, Azimut); //Qfeb
        Td = GetMonthInfo(2, 3, Helling, Azimut);
        Zu = GetMonthInfo(2, 4, Helling, Azimut);
        Wh = GetMonthInfo(2, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.11;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qfeb = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qfeb < 0) { Qfeb = 0; }

        Mdagen = GetMonthInfo(3, 2, Helling, Azimut); //Qmar
        Td = GetMonthInfo(3, 3, Helling, Azimut);
        Zu = GetMonthInfo(3, 4, Helling, Azimut);
        Wh = GetMonthInfo(3, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.06;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qmar = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qmar < 0) { Qmar = 0; }

        Mdagen = GetMonthInfo(4, 2, Helling, Azimut); //Qapr
        Td = GetMonthInfo(4, 3, Helling, Azimut);
        Zu = GetMonthInfo(4, 4, Helling, Azimut);
        Wh = GetMonthInfo(4, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.13;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qapr = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qapr < 0) { Qapr = 0; }

        Mdagen = GetMonthInfo(5, 2, Helling, Azimut); //Qmei
        Td = GetMonthInfo(5, 3, Helling, Azimut);
        Zu = GetMonthInfo(5, 4, Helling, Azimut);
        Wh = GetMonthInfo(5, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.05;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qmei = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qmei < 0) { Qmei = 0; }

        Mdagen = GetMonthInfo(6, 2, Helling, Azimut); //Qjun
        Td = GetMonthInfo(6, 3, Helling, Azimut);
        Zu = GetMonthInfo(6, 4, Helling, Azimut);
        Wh = GetMonthInfo(6, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.04;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qjun = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qjun < 0) { Qjun = 0; }

        Mdagen = GetMonthInfo(7, 2, Helling, Azimut); //Qjul
        Td = GetMonthInfo(7, 3, Helling, Azimut);
        Zu = GetMonthInfo(7, 4, Helling, Azimut);
        Wh = GetMonthInfo(7, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.01;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qjul = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qjul < 0) { Qjul = 0; }

        //boilermaatuitcollector = 1000 * rendementbijT0 * Apertuuroppervlak * 10 * 3600 / (4186 * 50); // 50 graden verhoging - 10 uur 1000 wm2

        double dagopbrengstkwhjuli = Math.Round(Zu * SolarRadiation * rendement / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        boilermaatuitcollector = dagopbrengstkwhjuli * 1000 * 3600 / (4186 * 40); // 40 graden verhoging - tijd en instraling uit db voor juli


        Mdagen = GetMonthInfo(8, 2, Helling, Azimut); //Qaug
        Td = GetMonthInfo(8, 3, Helling, Azimut);
        Zu = GetMonthInfo(8, 4, Helling, Azimut);
        Wh = GetMonthInfo(8, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.07;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qaug = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qaug < 0) { Qaug = 0; }

        Mdagen = GetMonthInfo(9, 2, Helling, Azimut); //Qsep
        Td = GetMonthInfo(9, 3, Helling, Azimut);
        Zu = GetMonthInfo(9, 4, Helling, Azimut);
        Wh = GetMonthInfo(9, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.05;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qsep = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qsep < 0) { Qsep = 0; }

        Mdagen = GetMonthInfo(10, 2, Helling, Azimut); //Qoct
        Td = GetMonthInfo(10, 3, Helling, Azimut);
        Zu = GetMonthInfo(10, 4, Helling, Azimut);
        Wh = GetMonthInfo(10, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.07;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qoct = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qoct < 0) { Qoct = 0; }

        Mdagen = GetMonthInfo(11, 2, Helling, Azimut); //Qnov
        Td = GetMonthInfo(11, 3, Helling, Azimut);
        Zu = GetMonthInfo(11, 4, Helling, Azimut);
        Wh = GetMonthInfo(11, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 1.08;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qnov = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qnov < 0) { Qnov = 0; }

        Mdagen = GetMonthInfo(12, 2, Helling, Azimut); //Qdec
        Td = GetMonthInfo(12, 3, Helling, Azimut);
        Zu = GetMonthInfo(12, 4, Helling, Azimut);
        Wh = GetMonthInfo(12, 5, Helling, Azimut);
        SolarRadiation = Wh / Zu * 0.95;
        a1 = Coefficient1 * (ColTemp - Td) / SolarRadiation;
        a2 = Coefficient2 * (ColTemp - Td) * (ColTemp - Td) / SolarRadiation;
        rendement = rendementbijT0 - a1 - a2;
        Qdec = Math.Round(Zu * SolarRadiation * rendement * Mdagen / 1000 * Apertuuroppervlak * IAM * verliezen, 0);
        if (Qdec < 0) { Qdec = 0; }

        QjaarBruto = Qjan + Qfeb + Qmar + Qapr + Qmei + Qjun + Qjul + Qaug + Qsep + Qoct + Qnov + Qdec;





        // correctie boilerverlies per maand

        Bstby = BoilerLoss(boilermaatuitcollector / 0.67);
        double Qsover;
        double BverlMaand;
        //Brend = GetCollectorInfo(idx + 1, 8); // BoilerSize rendement
        //Bstby = GetCollectorInfo(idx + 1, 9); // boiler standby verlies
        Bverl = Bstby * 24 * 366 / 1000;  // jaarverlies

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // jan
        if (Qjan > Pjan) { QjanNetto = Qjan - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qjan <= Pjan) { QjanNetto = Qjan - (Qjan / Pjan * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QjanNetto < 0) { QjanNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // feb
        if (Qfeb > Pfeb) { QfebNetto = Qfeb - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qfeb <= Pfeb) { QfebNetto = Qfeb - (Qfeb / Pfeb * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QfebNetto < 0) { QfebNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // mar
        if (Qmar > Pmar) { QmarNetto = Qmar - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qmar <= Pmar) { QmarNetto = Qmar - (Qmar / Pmar * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QmarNetto < 0) { QmarNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // apr
        if (Qapr > Papr) { QaprNetto = Qapr - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qapr <= Papr) { QaprNetto = Qapr - (Qapr / Papr * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QaprNetto < 0) { QaprNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // mei
        if (Qmei > Pmei) { QmeiNetto = Qmei - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qmei <= Pmei) { QmeiNetto = Qmei - (Qmei / Pmei * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QmeiNetto < 0) { QmeiNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // jun
        if (Qjun > Pjun) { QjunNetto = Qjun - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qjun <= Pjun) { QjunNetto = Qjun - (Qjun / Pjun * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QjunNetto < 0) { QjunNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // jul
        if (Qjul > Pjul) { QjulNetto = Qjul - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qjul <= Pjul) { QjulNetto = Qjul - (Qjul / Pjul * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QjulNetto < 0) { QjulNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // aug
        if (Qaug > Paug) { QaugNetto = Qaug - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qaug <= Paug) { QaugNetto = Qaug - (Qaug / Paug * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QaugNetto < 0) { QaugNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // sep
        if (Qsep > Psep) { QsepNetto = Qsep - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qsep <= Psep) { QsepNetto = Qsep - (Qsep / Psep * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QsepNetto < 0) { QsepNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // oct
        if (Qoct > Poct) { QoctNetto = Qoct - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qoct <= Poct) { QoctNetto = Qoct - (Qoct / Poct * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QoctNetto < 0) { QoctNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // nov
        if (Qnov > Pnov) { QnovNetto = Qnov - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qnov <= Pnov) { QnovNetto = Qnov - (Qnov / Pnov * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QnovNetto < 0) { QnovNetto = 0; } // correct negative values from calc

        BverlMaand = Bstby * 24 * GetMonthInfo(1, 2, Helling, Azimut) / 1000; // dec
        if (Qdec > Pdec) { QdecNetto = Qdec - BverlMaand; } // more then enough energy collected for full boiler heat loss
        if (Qdec <= Pdec) { QdecNetto = Qdec - (Qdec / Pdec * BverlMaand); } // less energy collected, take waighted fraction heatloss
        if (QdecNetto < 0) { QdecNetto = 0; } // correct negative values from calc



        // calc BoilerSize

        // idx = Array.IndexOf(CollectorChoices, Collector);

        // BoilerSize = GetCollectorInfo(idx + 1, 6);// first = 1 based array function


        // bereken voor de stookmaanden hoeveel energie er over is. (bruto - gewogen boilerverlies/maand)
        // boiler verliezen noemen ze recoverable losses in SOLEN
        Qsover = 0;
        if (QjanNetto > Pjan) { Qsover = Qsover + QjanNetto - Pjan; }
        if (QfebNetto > Pfeb) { Qsover = Qsover + QfebNetto - Pfeb; }
        if (QmarNetto > Pmar) { Qsover = Qsover + QmarNetto - Pmar; }
        if (QaprNetto > Papr) { Qsover = Qsover + QaprNetto - Papr; }
        if (QsepNetto > Psep) { Qsover = Qsover + QsepNetto - Psep; }
        if (QoctNetto > Poct) { Qsover = Qsover + QoctNetto - Poct; }
        if (QnovNetto > Pnov) { Qsover = Qsover + QnovNetto - Pnov; }
        if (QdecNetto > Pdec) { Qsover = Qsover + QdecNetto - Pdec; }

        // bereken dekkingsgraad
        if (QjanNetto > Pjan) { janDekking = Pjan; }
        if (QjanNetto <= Pjan) { janDekking = QjanNetto; }

        if (QfebNetto > Pfeb) { febDekking = Pfeb; }
        if (QfebNetto <= Pfeb) { febDekking = QfebNetto; }

        if (QmarNetto > Pmar) { marDekking = Pmar; }
        if (QmarNetto <= Pmar) { marDekking = QmarNetto; }

        if (QaprNetto > Papr) { aprDekking = Papr; }
        if (QaprNetto <= Papr) { aprDekking = QaprNetto; }

        if (QmeiNetto > Pmei) { meiDekking = Pmei; }
        if (QmeiNetto <= Pmei) { meiDekking = QmeiNetto; }

        if (QjunNetto > Pjun) { junDekking = Pjun; }
        if (QjunNetto <= Pjun) { junDekking = QjunNetto; }

        if (QjulNetto > Pjul) { julDekking = Pjul; }
        if (QjulNetto <= Pjul) { julDekking = QjulNetto; }

        if (QaugNetto > Paug) { augDekking = Paug; }
        if (QaugNetto <= Paug) { augDekking = QaugNetto; }

        if (QsepNetto > Psep) { sepDekking = Psep; }
        if (QsepNetto <= Psep) { sepDekking = QsepNetto; }

        if (QoctNetto > Poct) { octDekking = Poct; }
        if (QoctNetto <= Poct) { octDekking = QoctNetto; }

        if (QnovNetto > Pnov) { novDekking = Pnov; }
        if (QnovNetto <= Pnov) { novDekking = QnovNetto; }

        if (QdecNetto > Pdec) { decDekking = Pdec; }
        if (QdecNetto <= Pdec) { decDekking = QdecNetto; }




        // Qaux, Qtota, Nwh
        Qaux = GetCollectorInfo(idx + 1, 7) * 1800 / 1000 + 0.5 * 24 * 366 / 1000;
        Qtota = Qnonsol + Qaux;
        Nwh = 0.7 * 366 * Qref / Qtota * 100;
        double dekkingsopbrengst = janDekking + febDekking + marDekking + aprDekking + meiDekking + junDekking + julDekking + augDekking + sepDekking + octDekking + novDekking + decDekking;
        double TwDekking = dekkingsopbrengst / Pjaar * 100;


        // calc EuroGain

        // gasketel geeft 8.22 kWh/m3 gas
        // 1 joule=1w/s
        double m3gas;

        m3gas = (dekkingsopbrengst + Qsover) / 8.22;
        // opbrengst x energiekosten
        OpbrengstElek = (dekkingsopbrengst + Qsover) * kWhPrijs - (Qaux * kWhPrijs);
        OpbrengstGas = m3gas * GASPrijsM3 - Qaux * kWhPrijs;



        this.Url.RouteUrl(this.ViewContext.RouteData.Values);
             

        <script asp-location="Footer">@Qjan@Qfeb@Qmar@Qapr@Qmei@Qjun@Qjul@Qaug@Qsep@Qoct@Qnov@Qdec@Profiel@Pjan@Pfeb@Pmar@Papr@Pmei@Pjun@Pjul@Paug@Psep@Poct@Pnov@Pdec</script>

        var customer = User.Identity.Name;
        var InBereken = false;
        var IsAdmin = false;
        var IsAuthenticated = User.Identity.IsAuthenticated;

        if (_customerService.IsInCustomerRole(_workContext.CurrentCustomer, "Bereken"))
        {
            InBereken = true;
        }

        if (_customerService.IsInCustomerRole(_workContext.CurrentCustomer, "Administrators"))
        {
            IsAdmin = true;
        }

        <table style="font-size:10pt">

            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>

            <tr>
                <td>Tapwater profiel</td>
                <td>Liter/dag</td>

                <td><input id="Param1" value="@(Profiel)" /></td>

            </tr>

            <tr>
                <td>Collector</td>
                <td>Type</td>
                <td>

                    <select id="Param2">

                        <option selected='@(Collector == CollectorChoices[0] ? true : false)'>@CollectorChoices[0]</option><!-- PRISMA -->
                        <option selected='@(Collector == CollectorChoices[1] ? true : false)'>@CollectorChoices[1]</option> <!-- kingspan HP-->
                        <option selected='@(Collector == CollectorChoices[2] ? true : false)'>@CollectorChoices[2]</option><!--Kingspan DF -->
                        <option selected='@(Collector == CollectorChoices[3] ? true : false)'>@CollectorChoices[3]</option> <!-- 4Plus-->
                        <option selected='@(Collector == CollectorChoices[4] ? true : false)'>@CollectorChoices[4]</option> <!-- 2Plus -->
                        <option selected='@(Collector == CollectorChoices[5] ? true : false)'>@CollectorChoices[5]</option> <!-- ensol pvt -->
                        @if (@InBereken)
                        {
                            <option selected='@(Collector == CollectorChoices[6] ? true : false)'>@CollectorChoices[6]</option>
                            <!-- sunrain -->
                            <option selected='@(Collector == CollectorChoices[7] ? true : false)'>@CollectorChoices[7]</option>
                            <!-- TVP -->
                        }
                    </select>

                </td>
            </tr>

            <tr>
                <td>Collector of buizen</td>
                <td>Aantal</td>
                <td><input id="Param8" value="@(collectoraantal)" /></td>
            </tr>

            <tr>
                <td>Gemiddelde watertemperatuur</td>
                <td>Graden</td>
                <td>

                    <select id="Param7">
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[0] ? true : false)'>@gemiddeldewatertemperatuur[0]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[1] ? true : false)'>@gemiddeldewatertemperatuur[1]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[2] ? true : false)'>@gemiddeldewatertemperatuur[2]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[3] ? true : false)'>@gemiddeldewatertemperatuur[3]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[4] ? true : false)'>@gemiddeldewatertemperatuur[4]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[5] ? true : false)'>@gemiddeldewatertemperatuur[5]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[6] ? true : false)'>@gemiddeldewatertemperatuur[6]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[7] ? true : false)'>@gemiddeldewatertemperatuur[7]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[8] ? true : false)'>@gemiddeldewatertemperatuur[8]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[9] ? true : false)'>@gemiddeldewatertemperatuur[9]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[10] ? true : false)'>@gemiddeldewatertemperatuur[10]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[11] ? true : false)'>@gemiddeldewatertemperatuur[11]</option>
                        <option selected='@(ColTemp == gemiddeldewatertemperatuur[12] ? true : false)'>@gemiddeldewatertemperatuur[12]</option>
                        @if (@InBereken)
                        {
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[13] ? true : false)'>@gemiddeldewatertemperatuur[13]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[14] ? true : false)'>@gemiddeldewatertemperatuur[14]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[15] ? true : false)'>@gemiddeldewatertemperatuur[15]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[16] ? true : false)'>@gemiddeldewatertemperatuur[16]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[17] ? true : false)'>@gemiddeldewatertemperatuur[17]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[18] ? true : false)'>@gemiddeldewatertemperatuur[18]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[19] ? true : false)'>@gemiddeldewatertemperatuur[19]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[20] ? true : false)'>@gemiddeldewatertemperatuur[20]</option>
                            <option selected='@(ColTemp == gemiddeldewatertemperatuur[21] ? true : false)'>@gemiddeldewatertemperatuur[21]</option>
                        }


                    </select>

                </td>

            </tr>



            <tr>
                <td>Collector helling (van 0º tot 90º)</td>
                <td>Graden</td>
                <td>
                    <select id="Param5">
                        <option selected='@(Helling == 5 ?true : false)'>5</option>
                        <option selected='@(Helling == 0 ?true : false)'>0</option>
                        <option selected='@(Helling == 10 ? true : false)'>10</option>
                        <option selected='@(Helling == 15 ? true : false)'>15</option>
                        <option selected='@(Helling == 20 ? true : false)'>20</option>
                        <option selected='@(Helling == 25 ? true : false)'>25</option>
                        <option selected='@(Helling == 30 ? true : false)'>30</option>
                        <option selected='@(Helling == 35 ? true : false)'>35</option>
                        <option selected='@(Helling == 40 ? true : false)'>40</option>
                        <option selected='@(Helling == 45 ? true : false)'>45</option>
                        <option selected='@(Helling == 50 ? true : false)'>50</option>
                        <option selected='@(Helling == 55 ? true : false)'>55</option>
                        <option selected='@(Helling == 60 ? true : false)'>60</option>
                        <option selected='@(Helling == 65 ? true : false)'>65</option>
                        <option selected='@(Helling == 70 ? true : false)'>70</option>
                        <option selected='@(Helling == 75 ? true : false)'>75</option>
                        <option selected='@(Helling == 80 ? true : false)'>80</option>
                        <option selected='@(Helling == 85 ? true : false)'>85</option>
                        <option selected='@(Helling == 90 ? true : false)'>90</option>
                    </select>


                </td>
            </tr>
            <tr>
                <td>Collector richting (Oost tot West)</td>
                <td>Kompasrichting</td>
                <td>
                    <select id="Param6">
                        <option selected='@(Azimut == AzimutChoices[0] ? true : false)'>@AzimutChoices[0]</option>
                        <option selected='@(Azimut == AzimutChoices[1] ? true : false)'>@AzimutChoices[1]</option>
                        <option selected='@(Azimut == AzimutChoices[2] ? true : false)'>@AzimutChoices[2]</option>
                        <option selected='@(Azimut == AzimutChoices[3] ? true : false)'>@AzimutChoices[3]</option>
                        <option selected='@(Azimut == AzimutChoices[4] ? true : false)'>@AzimutChoices[4]</option>
                        <option selected='@(Azimut == AzimutChoices[5] ? true : false)'>@AzimutChoices[5]</option>
                        <option selected='@(Azimut == AzimutChoices[6] ? true : false)'>@AzimutChoices[6]</option>
                        <option selected='@(Azimut == AzimutChoices[7] ? true : false)'>@AzimutChoices[7]</option>
                        <option selected='@(Azimut == AzimutChoices[8] ? true : false)'>@AzimutChoices[8]</option>
                    </select>
                </td>
            </tr>

            @if (@InBereken && @IsAdmin)
            {
            }

            <tr>
                <td>Stroomprijs per kWh</td>
                <td>€</td>
                <td><input id="Param3" value="@Math.Round(@kWhPrijs,2)" /></td>
            </tr>

            <tr>
                <td>Gasprijs per M3</td>
                <td>€</td>
                <td><input id="Param4" value="@Math.Round(@GASPrijsM3,2)" /></td>
            </tr>




        </table>
        //<script>
        //    function info(){
        //        document.getElementById('hulp').innerHTML = "<br /><a href=/login style=color:red;text-decoration:underline>U moet aangemeld zijn als een geregistreerde gebruiker om een berekening te kunnen maken, registratie en gebruik is gratis</a>"
        //    }
        // </script>

        //<br />
        //if (IsAuthenticated)
        //{
        <input type="button" value="Opnieuw berekenen" onclick="" />
        //}
        //else
        //{
        //    <input type="button" value="Opnieuw berekenen" onclick="info()" />
        //}

        //<br />
        //    <div id="hulp"></div>
        //<br />

        <br />
        <table height="350" style="width:100%">
            <tr><td><div id="legendDiv"></div></td></tr>
            <tr><td><canvas id="canvas"></canvas></td></tr>
        </table>


        <table style="font-size:10pt">

            <tr style="font-weight:bold;"><td width="450">Naam</td><td>Eenheid</td><td>Waarde</td></tr>
            <tr><td colspan="3"><hr /></td></tr>

            <tr>
                <td>Benodigde energie volgens tapwater profiel - @Profiel Liter</td>
                <td>kWh</td>
                <td>@Math.Round(@Pjaar, 0)</td>
            </tr>

            <tr>
                <td>Opgewekte zonne-energie (bruto)</td>
                <td>kWh</td>
                <td>@Math.Round(@QjaarBruto, 0)</td>
            </tr>

            <tr>
                <td>Dekkingsgraad warm tapwater behoefte</td>
                <td>%</td>
                <td>@Math.Round(TwDekking, 0)</td>
                <!--td>@Math.Round((Pjaar-Qnonsol-Qaux-Bverl)/(Pjaar/100), 0)</td-->
            </tr>

            <tr>
                <td>Energie voor verwarmingsondersteuning</td>
                <td>kWh</td>
                <td>@Math.Round(Qsover, 0)</td>
            </tr>
            <tr><td colspan="3"><hr /></td></tr>
            <tr>
                <td>Boilermaat drinkwaterboiler uit tapwater profiel (65ºC boiler temperatuur)</td>
                <td>Liter</td>
                <td>@Math.Round(Profiel / 1.5, 0)</td>
            </tr>

            <tr>
                <td>Boilermaat hygieneboiler uit tapwater profiel (65ºC boiler temperatuur)</td>
                <td>Liter</td>
                <td>@Math.Round(Profiel / 0.67, 0)</td>
            </tr>
            <tr>
                <td>Boilermaat uit collector vermogen met gem. instraling (+40ºC boiler verhoging)</td>
                <td>Liter</td>
                <td>@Math.Round(boilermaatuitcollector, 0)</td>
            </tr>
            <tr>
                <td>Boilermaat uit collector vermogen met piek instraling (+40ºC boiler verhoging)</td>
                <td>Liter</td>
                <td>@Math.Round(boilermaatuitcollector * 2, 0)</td>
            </tr>
            <tr><td colspan="3"><hr /></td></tr>


            <tr>
                <td>Opbrengst prognose per jaar in vergelijking met CV gasketel-opwarming</td>
                <td>€</td>
                <td>@Math.Round(@OpbrengstGas, 0)</td>
            </tr>

            <tr>
                <td>Opbrengst prognose per jaar in vergelijking met elektrische-opwarming</td>
                <td>€</td>
                <td>@Math.Round(@OpbrengstElek, 0)</td>
            </tr>
            <tr><td colspan="3"><hr /></td></tr>

            <tr><td>&nbsp;</td></tr>

            <tr>
                <td><b>Collector specificaties</b></td>
                <td></td>
                <td></td>
            </tr>
            <tr><td colspan="3"><hr /></td></tr>
            <tr>
                <td>Apertuur oppervlakte</td>
                <td>m2</td>
                <td>@Math.Round(@Apertuuroppervlak, 2)</td>
            </tr>
            <tr>
                <td>Optisch rendement</td>
                <td>n0</td>
                <td>@rendementbijT0</td>
            </tr>
            <tr>
                <td>Collector piekvermogen</td>
                <td>Watt-piek</td>
                <td>@Math.Round(@rendementbijT0 * 1000 * @Apertuuroppervlak, 0)</td>
            </tr>
            <tr>
                <td>Warmte verliesfactor</td>
                <td>a1</td>
                <td>@Coefficient1</td>
            </tr>
            <tr>
                <td>Warmte verliesfactor</td>
                <td>a2</td>
                <td>@Coefficient2</td>
            </tr>
            <tr>
                <td>Instralingscorrectie tgv reflectie</td>
                <td>IAM</td>
                <td>@IAM</td>
            </tr>

            <tr>
                <td>Gemiddelde watertemperatuur</td>
                <td>ºC</td>
                <td>@ColTemp</td>
            </tr>
            <tr><td colspan="3"><hr /></td></tr>

            <tr>

                <td><b>Subsidie setjes</b></td>
                <td>
                    <b>
                        @if (Collector == CollectorChoices[0])
                        {@Html.Raw(("<a style='color:orange;' href='https://www.econo.nl/zonnecollectoren#/specFilters=68m!#-!283'>Prisma Pro</a>"))}
                        @if (Collector == CollectorChoices[1])
                        {@Html.Raw(("<a style='color:orange;' href='https://www.econo.nl/zonnecollectoren#/specFilters=68m!#-!284'>Kingspan Heatpipe</a>"))}
                        @if (Collector == CollectorChoices[2])
                        {@Html.Raw(("<a style='color:orange;' href='https://www.econo.nl/contactus'>Kingspan DirectFlow op aanvraag</a>"))}
                        @if (Collector == CollectorChoices[3])
                        {@Html.Raw(("<a style='color:orange;' href='https://www.econo.nl/zonnecollectoren#/specFilters=68m!#-!285'>4Plus Vlakkeplaat</a>"))}
                        @if (Collector == CollectorChoices[4])
                        {@Html.Raw(("<a style='color:orange;' href='https://www.econo.nl/zonnecollectoren#/specFilters=68m!#-!301'>2Plus Vlakkeplaat</a>"))}
                    </b>

                </td>
            </tr>

            @if (@InBereken && @IsAdmin)
            {

                <tr>
                    <td>Expert</td>
                    <td>Radiation</td>
                    <td>@GetMonthInfo(1, 5, Helling, Azimut) - @GetMonthInfo(2, 5, Helling, Azimut) - @GetMonthInfo(1, 4, Helling, Azimut) -  @GetMonthInfo(2, 4, Helling, Azimut)</td>
                </tr>

                <tr>
                    <td>Expert</td>
                    <td>kWh-juli-dag</td>
                    <td>@dagopbrengstkwhjuli</td>
                </tr>

                <tr>
                    <td>Expert</td>
                    <td>Boiler verlies</td>
                    <td>@Bstby</td>
                </tr>


            }

        </table>

        <br />

        <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }


</div>

    <div class="Berekening expansievat CV">
        @if (Model.Name == "Berekening expansievat CV")
        {
 

            double SysteemInhoud = 0;
            double SysteemDruk = 0;
            double MaxDruk = 0;
            double MaxTemp = 0;
            double Voordruk = 0;
            double WaterExpansion = 0;
            double ExpansievatInhoud = 0;
            double NuttigEffect = 0;
            try
            {
                SysteemInhoud = Convert.ToDouble(Model.Param1);
                SysteemDruk = Convert.ToDouble(Model.Param2); MaxDruk = Convert.ToDouble(Model.Param3);
                MaxTemp = Convert.ToDouble(Model.Param4);
                Voordruk = Convert.ToDouble(Model.Param5);
                WaterExpansion = Convert.ToDouble(Model.Param6);
                ExpansievatInhoud = Convert.ToDouble(Model.Param7);
            }
            catch
            {
            <script ></script>
            }

            if (SysteemInhoud == 0 && SysteemDruk == 0 && MaxDruk == 0 && MaxTemp == 0) // demo waarden invullen
            {
                SysteemInhoud = 200;
                SysteemDruk = 1.5;
                MaxDruk = 2.5;
                MaxTemp = 85;
            }
            //make calculation here
            Voordruk = SysteemDruk - 0.3;

            if (MaxTemp > 20 && MaxTemp <= 100)
            {
                WaterExpansion = GetWaterExpansion(Convert.ToInt16(MaxTemp)) / 100 * SysteemInhoud;
            }
            else
            {
                WaterExpansion = 0;
            }

            NuttigEffect = ((1 + MaxDruk) - (1 + Voordruk)) / (1 + MaxDruk);
            if (NuttigEffect > .63) { NuttigEffect = .63; } // te grote vulling, kans op membraam breuk
            ExpansievatInhoud = WaterExpansion * 1.25 / NuttigEffect;
            if (ExpansievatInhoud >= 800) { ExpansievatInhoud = 999999999999; }

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

 
    <table>
        <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
        <tr><td>CV inhoud koude vultoestand (20 ºC)</td><td>Liter (L)</td><td><input id="Param1" value="@SysteemInhoud" /></td></tr>
        <tr><td>Systeem druk CV installatie koude toestand</td><td>Bar (B)</td><td><input id="Param2" value="@SysteemDruk" /></td></tr>
        <tr><td>Maximum systeem druk</td><td>Bar (B)</td><td><input id="Param3" value="@MaxDruk" /></td></tr>
        <tr><td>@Html.Raw("Maximum temperatuur (>20 en <= 100)")</td><td>Graden Celcius(ºC)</td><td><input id="Param4" value="@MaxTemp" /></td></tr>
        <tr><td>Voordruk losgekoppeld expansievat</td><td>Bar (B)</td><td><input id="Param5" disabled="disabled" value="@Voordruk" /></td></tr>
        <tr><td>Volume toename</td><td>Liter (L)</td><td><input id="Param6" disabled="disabled" value="@Math.Round(WaterExpansion,2)" /></td></tr>
        <tr><td>Inhoud (tot max. 800 liter versie)</td><td>Liter (L)</td><td><input id="Param7" disabled="disabled" value="@Math.Round(@ExpansievatInhoud,2)" /></td></tr>
    </table>
    <br />
         <input type="button" value="Opnieuw berekenen" onclick="" />
    <br />
    <br />

    <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

    </div>

    <div class="Berekening expansievat zonneboiler">
        @if (Model.Name == "Berekening expansievat zonneboiler")
        {
            double SysteemInhoud = 0;
            double SysteemDruk = 0;
            double MaxDruk = 0;
            double InhoudCollectoren = 0;
            double Voordruk = 0;
            double GlycolWaterExpansion = 0;
            double ExpansievatInhoud = 0;
            double NuttigEffect = 0;
            try
            {
                SysteemInhoud = Convert.ToDouble(Model.Param1);
                SysteemDruk = Convert.ToDouble(Model.Param2); MaxDruk = Convert.ToDouble(Model.Param3);
                InhoudCollectoren = Convert.ToDouble(Model.Param4);
                Voordruk = Convert.ToDouble(Model.Param5);
                GlycolWaterExpansion = Convert.ToDouble(Model.Param6);
                ExpansievatInhoud = Convert.ToDouble(Model.Param7);
            }
            catch
            {
            <script></script>
            }

            if (SysteemInhoud == 0 && SysteemDruk == 0 && MaxDruk == 0 && InhoudCollectoren == 0) // demo waarden invullen
            {
                SysteemInhoud = 20;
                SysteemDruk = 1.5;
                MaxDruk = 4.5;
                InhoudCollectoren = 4;
            }

            //make calculation here
            Voordruk = SysteemDruk - 0.3;

            GlycolWaterExpansion = GetWaterExpansion(Convert.ToInt16(100)) / 100 * 1.8 * SysteemInhoud + InhoudCollectoren;

            NuttigEffect = ((1 + MaxDruk) - (1 + Voordruk)) / (1 + MaxDruk);
            if (NuttigEffect > .63) { NuttigEffect = .63; } // te grote vulling, kans op membraam breuk
            ExpansievatInhoud = GlycolWaterExpansion * 1.25 / NuttigEffect;
            if (ExpansievatInhoud >= 800) { ExpansievatInhoud = 999999999999; }

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

    <table >
        <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
        <tr><td>Solar vloeistof inhoud koude vultoestand (20 ºC)</td><td>Liter (L)</td><td><input id="Param1" value="@SysteemInhoud" /></td></tr>
        <tr><td>Solar systeem druk koude toestand</td><td>Bar (B)</td><td><input id="Param2" value="@SysteemDruk" /></td></tr>
        <tr><td>Maximum systeem druk</td><td>Bar (B)</td><td><input id="Param3" value="@MaxDruk" /></td></tr>
        <tr><td>Solar vloeistof inhoud collectoren</td><td>Liter (L)</td><td><input id="Param4" value="@InhoudCollectoren" /></td></tr>
        <tr><td>Voordruk losgekoppeld expansievat</td><td>Bar (B)</td><td><input id="Param5" disabled="disabled" value="@Voordruk" /></td></tr>
        <tr><td>Volume toename bij stagnatie</td><td>Liter (L)</td><td><input id="Param6" disabled="disabled" value="@Math.Round(GlycolWaterExpansion, 2)" /></td></tr>
        <tr><td>Inhoud </td><td>Liter (L)</td><td><input id="Param7" disabled="disabled" value="@Math.Round(@ExpansievatInhoud,2)" /></td></tr>
    </table>
    <br />
    <input type="button" value="Opnieuw berekenen" onclick="" />

    <br />
    <br />

    <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

    </div>

    <div class="Berekening boiler opwarming">
        @if (Model.Name == "Berekening boiler opwarming")
        {
            double BoilerCapacity = 0;
            double HeatCapacity = 0;
            double HeatingTime = 0;
            double TemperatureIncrement = 0;
            double Joules = 0;

            try
            {
                BoilerCapacity = Convert.ToDouble(Model.Param1);
                HeatCapacity = Convert.ToDouble(Model.Param2);
                HeatingTime = Convert.ToDouble(Model.Param3);
                TemperatureIncrement = Convert.ToDouble(Model.Param4);
            }
            catch
            {
            <script></script>
            }

            if (BoilerCapacity == 0 && HeatCapacity == 0 && HeatingTime == 0) // demo waarden invullen
            {
                BoilerCapacity = 300;
                HeatCapacity = 3.5;
                HeatingTime = 240;
            }


            //make calculation here

            Joules = HeatCapacity * 1000 * HeatingTime * 60; // watt sec -- Joule
            TemperatureIncrement = Joules / 4183 / BoilerCapacity;

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

    <table >
        <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
        <tr><td>Boiler inhoud</td><td>Liter (L)</td><td><input id="Param1" value="@BoilerCapacity" /></td></tr>
        <tr><td>Toegevoerd vermogen</td><td>Kilowatt (kW)</td><td><input id="Param2" value="@HeatCapacity" /></td></tr>
        <tr><td>Opwarmtijd</td><td>Minuten (m)</td><td><input id="Param3" value="@HeatingTime" /></td></tr>
        <tr><td>Temperatuurverhoging</td><td>Graden Celcius (ºC)</td><td><input id="Param4" disabled="disabled" value="@Math.Round(@TemperatureIncrement,1)" /></td></tr>
    </table>


    <br />
    <input type="button" value="Opnieuw berekenen" onclick="" />

    <br />
    <br />

    <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

    </div>

    <div class="Berekening boiler-douchetijd">
        @if (Model.Name == "Berekening boiler-douchetijd")
        {
            double BoilerCapacity = 0;
            double ColdWaterTemperature = 0;
            double ShowerTemperature = 0;
            double BoilerStartTemperature = 0;
            double ShowerFlowPerMInute = 0;
            double BoilerEnergyContent = 0;
            double ShowerEnergyUsagePerMinute = 0;
            double HeatSource = 0;
            double ShowerTime = 0;
            double AddEnergy = 0;
            string boilertype="Drinkwater boiler";
            double  orgcapacity = 0 ;
            
            try
            {
                BoilerCapacity = Convert.ToDouble(Model.Param1);
                BoilerStartTemperature = Convert.ToDouble(Model.Param2);
                ShowerTemperature = Convert.ToDouble(Model.Param3);
                ShowerFlowPerMInute = Convert.ToDouble(Model.Param4);
                ColdWaterTemperature = Convert.ToDouble(Model.Param5);
                HeatSource = Convert.ToDouble(Model.Param6);
                boilertype = Model.Param8 ;
                
            }
            catch
            {
            <script></script>
            }

            if (BoilerCapacity == 0 && BoilerStartTemperature == 0 && ShowerTemperature == 0) // demo waarden invullen
            {
                BoilerCapacity = 300;
                BoilerStartTemperature = 65;
                ShowerTemperature = 38;
                ShowerFlowPerMInute = 10;
                ColdWaterTemperature = 10;
                HeatSource = 0;
            }

            //make calculation here
            if (boilertype ==  "Drinkwater boiler")
            {
              orgcapacity = BoilerCapacity;
              BoilerCapacity = BoilerCapacity * 1.5;
            }
            
            
            BoilerEnergyContent = (BoilerStartTemperature - ShowerTemperature) * BoilerCapacity * 4183;
            ShowerEnergyUsagePerMinute = (ShowerTemperature - ColdWaterTemperature) * ShowerFlowPerMInute * 4183;
            AddEnergy = HeatSource * 1000 * 60;

            ShowerTime = BoilerEnergyContent / (ShowerEnergyUsagePerMinute - AddEnergy);
            if (ShowerTime <= 0) { ShowerTime = 999999999; }

            if (boilertype == "Drinkwater boiler")
            {
                BoilerCapacity = orgcapacity;
            }
                
            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

    <table >
        <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
        <tr>
            <td>Boiler type</td><td></td><td>
                <select id="Param8">
                    <option selected='@(boilertype == "Buffervat met doorstroomspiraal" ? "selected" : "")'>Buffervat met doorstroomspiraal</option>
                    <option selected='@(boilertype  == "Drinkwater boiler" ? "selected" : "")'>Drinkwater boiler</option>
                </select>
            </td>
        </tr>
        <tr><td>Boiler inhoud</td><td>Liters (L)</td><td><input id="Param1" value="@BoilerCapacity" /></td></tr>
        <tr><td>Boiler temperatuur</td><td>Graden Celcius (ºC)</td><td><input id="Param2" value="@BoilerStartTemperature" /></td></tr>
        <tr><td>Gewenste douche temperatuur</td><td>Graden Celcius (ºC)</td><td><input id="Param3" value="@ShowerTemperature" /></td></tr>
        <tr><td>Douche debiet</td><td>Liters/minuut (L/m)</td><td><input id="Param4" value="@ShowerFlowPerMInute" /></td></tr>
        <tr><td>Toestroom temperatuur koud water</td><td>Graden Celcius (ºC)</td><td><input id="Param5" value="@Math.Round(@ColdWaterTemperature, 1)" /></td></tr>
        <tr><td>Gelijktijdige warmtebron</td><td>Kilowatt(kW)</td><td><input id="Param6" value="@HeatSource" /></td></tr>
        <tr><td>Beschikbare douchetijd</td><td>minuten (m)</td><td><input id="Para7" disabled="disabled" value="@Math.Round(@ShowerTime, 0)" /></td></tr>
    </table>
    <br />
    <input type="button" value="Opnieuw berekenen" onclick="" />

    <br />
    <br />

    <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

    </div>

    <div class="Berekening aansluitvermogen doorstroomverwarmer">
        @if (Model.Name == "Berekening aansluitvermogen doorstroomverwarmer")
        {
            double DesiredFlow = 0;
            double DesiredTemperature = 0;
            double ColdWaterTemperature = 0;
            double kW = 0;
            string Connection = "";
            string Fuse = "";
            string[] _Fuse = new string[] { "16", "20", "25", "35", "50", "63", "80", "100", "125", "250", "400", "500", "630" };
            string[] _Connection = new string[] { "1 groep ", "1 fase ", "3 fase " };
            string Merk1Url = "";
            string Merk2Url = "";
            string Merk3Url = "";

            try
            {
                DesiredFlow = Convert.ToDouble(Model.Param1);
                ColdWaterTemperature = Convert.ToDouble(Model.Param2);
                DesiredTemperature = Convert.ToDouble(Model.Param3);
            }
            catch
            {
            <script></script>
            }

            if (DesiredFlow == 0 && ColdWaterTemperature == 0 && DesiredTemperature == 0) // demo waarden invullen
            {
                DesiredFlow = 5;
                ColdWaterTemperature = 12;
                DesiredTemperature = 38;
            }
            //make calculation here

            kW = DesiredFlow * (DesiredTemperature - ColdWaterTemperature) * 4183 / 60 / 1000;

            if (kW == 0)
            {

                Connection = "";
                Fuse = "";
                Merk1Url = "";
                Merk2Url = "";
                Merk3Url = "";

            }

            else if (kW * 1000 <= 16 * 230)
            {

                Connection = _Connection[0] + Convert.ToString(Math.Round(kW * 1000 / 230, 1)) + " A";
                Fuse = _Connection[0] + _Fuse[0] + " A";

                if (DesiredTemperature > 60) { Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>"; }
                else
                {
                    Merk1Url = "<a style='color:orange;text-decoration: underline' href='/clage-kleine-doorstroom-waterverwarmer-mbh-3'>Clage MDH 3</a>";
                    Merk2Url = "<a style='color:orange;text-decoration: underline' href='/clage-kleine-doorstroom-waterverwarmer-mcx-3'>Clage MCX 3</a>";
                    Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
                }
            }
            else if (kW * 1000 <= 3 * 16 * 230)
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[0] + " A";
                if (DesiredTemperature > 60) { Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>"; }
                else
                {
                    Merk1Url = "<a style='color:orange;text-decoration: underline' href='/model-cex-u-11-135-kw'>Clage CEX-U</a>";
                    Merk2Url = "<a style='color:orange;text-decoration: underline' href='/clage-cex-u-11-135-kw'>Clage CEX</a>";
                    Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
                }
            }
            else if (kW * 1000 <= 3 * 20 * 230)
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[1] + " A";
                if (DesiredTemperature > 60) { Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>"; }
                else
                {
                    Merk1Url = "<a style='color:orange;text-decoration: underline' href='/model-cex-u-11-135-kw'>Clage CEX-U</a>";
                    Merk2Url = "<a style='color:orange;text-decoration: underline' href='/clage-cex-u-11-135-kw'>Clage CEX</a>";
                    Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
                }
            }
            else if (kW * 1000 <= 3 * 25 * 230) // 25A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[2] + " A";
                if (DesiredTemperature > 60) { Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>"; }
                else
                {
                    Merk1Url = "<a style='color:orange;text-decoration: underline' href='/clage-dbx-elektronic'>Clage DBX</a>";
                    Merk2Url = "<a style='color:orange;text-decoration: underline' href='/aeg'>AEG</a>";
                    Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
                }
            }
            else if (kW * 1000 <= 3 * 35 * 230) //35 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[3] + " A";
                if (DesiredTemperature > 60) { Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>"; }
                else
                {
                    Merk1Url = "<a style='color:orange;text-decoration: underline' href='/clage-dbx-elektronic'>Clage DBX</a>";
                    Merk2Url = "<a style='color:orange;text-decoration: underline' href='/aeg'>AEG</a>";
                    Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
                }
            }


            else if (kW * 1000 <= 3 * 50 * 230) // 50A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[4] + " A";
                if (DesiredTemperature > 60) { Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>"; }
                else
                {
                    Merk1Url = "<a style='color:orange;text-decoration: underline' href='/clage-dbx-elektronic'>Clage DBX</a>";
                    Merk2Url = "<a style='color:orange;text-decoration: underline' href='/aeg'>AEG</a>";
                    Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
                }
            }

            else if (kW * 1000 <= 3 * 63 * 230) // 63 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[5] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }
            else if (kW * 1000 <= 3 * 80 * 230) // 80 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[6] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }
            else if (kW * 1000 <= 3 * 100 * 230) // 100 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[7] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }

            else if (kW * 1000 <= 3 * 125 * 230) // 125 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[8] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }

            else if (kW * 1000 <= 3 * 250 * 230) // 250 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[9] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }

            else if (kW * 1000 <= 3 * 400 * 230) // 400 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[10] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }

            else if (kW * 1000 <= 3 * 500 * 230) // 500 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[11] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }

            else if (kW * 1000 <= 3 * 630 * 230) // 630 A
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + _Fuse[12] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";
            }
            else // > 630
            {
                Connection = _Connection[2] + Convert.ToString(Math.Round(kW * 1000 / 230 / 3, 1)) + " A";
                Fuse = _Connection[2] + "groter dan " + _Fuse[12] + " A";
                Merk3Url = "<a style='color:orange;text-decoration: underline' href='/rvs-drinkwater-doorstroomverwarmer'>Econo - industrieel</a>";

            }

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

    <table>
        <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
        <tr><td>Gewenst debiet</td><td>Liter/minuut (L/m)</td><td><input id="Param1" value="@DesiredFlow" /></td></tr>
        <tr><td>Toestroom temperatuur koudwater</td><td>Graden Celcius (ºC)</td><td><input id="Param2" value="@ColdWaterTemperature" /></td></tr>
        <tr><td>Gewenste uitgaande temperatuur</td><td>Graden Celcius (ºC)</td><td><input id="Param3" value="@DesiredTemperature" /></td></tr>
        <tr><td>Benodigd vermogen</td><td>kiloWatt (kW)</td><td><input id="Param4" disabled="disabled" value="@Math.Round(@kW, 1)" /></td></tr>
        <tr><td>Benodigde elektrische aansluiting</td><td>1 fase / 3 fase (Ampere)</td><td><input id="Param4" disabled="disabled" value="@Connection" /></td></tr>
        <tr><td>Benodigde zekeringwaarde</td><td>1 x / 3 x (Ampere)</td><td><input id="Param4" disabled="disabled" value="@Fuse" /></td></tr>

    </table>
    <br />
    <table>
        <tr style="font-weight:bold;"><td>Geschikte modellen zijn o.a.</td></tr>
        <tr><td>@Html.Raw(@Merk1Url)</td></tr>
        <tr><td>@Html.Raw(@Merk2Url)</td></tr>
        <tr><td>@Html.Raw(@Merk3Url)</td></tr>
    </table>
    <br />

    <input type="button" value="Opnieuw berekenen" onclick="" />

    <br />
    <br />

    <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

    </div>

    <div class="Conversietabel - BSP of gasdraad">
        @if (Model.Name == "Conversietabel - BSP of gasdraad")
        {
            double Milimeter = 0;
            double Inch = 0;
            string InchMmKeuze = "";
            try
            {
                Milimeter = Convert.ToDouble(Model.Param1);
                Inch = Convert.ToDouble(Model.Param2);
                InchMmKeuze = Model.Param3.TrimEnd();
            }
            catch
            {
            }

            if (Milimeter == 0 && Inch == 0) // demo waarden invullen
            {
                Milimeter = 25.4;
                Inch = Milimeter / 25.4;
            }

            //make calculation here
            if (InchMmKeuze == "Inch")
            {
                Inch = Milimeter / 25.4;

            }

            if (InchMmKeuze == "Mm")
            {
                Milimeter = Inch * 25.4;
            }

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

            <table >
                <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
                <tr><td>Milimeter</td><td>(mm)</td><td><input id="Param1" value="@Milimeter" /></td></tr>
                <tr><td>Inch</td><td>(")</td><td><input id="Param2" disabled="disabled" value="@Math.Round(@Inch,2)" /></td></tr>

            </table>
            <br />
            <input type="button" value="Bereken Inch" onclick="" />

            <br />    <br />    <br />

            <table >
                <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
                <tr><td>Inch</td><td>(")</td><td><input id="Param2a" value="@Inch" /></td></tr>
                <tr><td>Milimeter</td><td>(mm)</td><td><input id="Param1a" disabled="disabled" value="@Math.Round(@Milimeter,2)" /></td></tr>
            </table>
            <br />
            <input type="button" value="Bereken mm" onclick="" />


            <br />
            <br />

            <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
        }

    </div>

    <div class="Berekening leiding inhoud">
        @if (Model.Name == "Berekening leiding inhoud")
        {
            double LeidingLengte = 0;
            double LeidingDiameter = 0;
            double LeidingInhoud = 0;

            try
            {
                LeidingLengte = Convert.ToDouble(Model.Param1);
                LeidingDiameter = Convert.ToDouble(Model.Param2);
                LeidingInhoud = Convert.ToDouble(Model.Param3);
            }
            catch
            {
            <script></script>
            }

            if (LeidingLengte == 0 && LeidingDiameter == 0 && LeidingInhoud == 0) // demo waarden invullen
            {
                LeidingLengte = 1000;
                LeidingDiameter = 12;
                LeidingInhoud = 240;
            }


            //make calculation here

            LeidingInhoud = 3.14 * (LeidingDiameter / 2 / 10 * LeidingDiameter / 2 / 10) * LeidingLengte / 1000;

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);


    <table >
        <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
        <tr><td>Leiding lengte</td><td>centimeter (cm)</td><td><input id="Param1" value="@LeidingLengte" /></td></tr>
        <tr><td>Leiding diameter</td><td>milimeter (mm)</td><td><input id="Param2" value="@LeidingDiameter" /></td></tr>
        <tr><td>Leiding inhoud</td><td>Liters (L)</td><td><input id="Param3" disabled="disabled" value="@Math.Round(@LeidingInhoud,2)" /></td></tr>
    </table>


    <br />
    <input type="button" value="Opnieuw berekenen" onclick="" />

    <br />
    <br />

    <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

    </div>

    <div class="Berekening leiding oppervlakte">
        @if (Model.Name == "Berekening leiding oppervlakte")
        {
            double LeidingLengte = 0;
            double LeidingDiameter = 0;
            double LeidingOppervlakte = 0;

            try
            {
                LeidingLengte = Convert.ToDouble(Model.Param1);
                LeidingDiameter = Convert.ToDouble(Model.Param2);
                LeidingOppervlakte = Convert.ToDouble(Model.Param3);
            }
            catch
            {
            <script></script>
            }

            if (LeidingLengte == 0 && LeidingDiameter == 0 && LeidingOppervlakte == 0) // demo waarden invullen
            {
                LeidingLengte = 1000;
                LeidingDiameter = 12;
                LeidingOppervlakte = 240;
            }


            //make calculation here

            LeidingOppervlakte = 2 * 3.14 * (LeidingDiameter / 2 / 10) * LeidingLengte / 10000;

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

            <table width="500">
                <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
                <tr><td>Leiding lengte</td><td>centimeter (cm)</td><td><input id="Param1" value="@LeidingLengte" /></td></tr>
                <tr><td>Leiding diameter</td><td>milimeter (mm)</td><td><input id="Param2" value="@LeidingDiameter" /></td></tr>
                <tr><td>Leiding oppervlakte</td><td>Vierkante meter (m2)</td><td><input id="Param3" disabled="disabled" value="@Math.Round(@LeidingOppervlakte, 2)" /></td></tr>
            </table>


            <br />
            <input type="button" value="Opnieuw berekenen" onclick="" />

            <br />
            <br />

            <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
        }

    </div>


    <div class="Berekening warmtewisselaar oppervlakte">
        @if (Model.Name == "Berekening warmtewisselaar oppervlakte")
        {
            double T1 = 0;
            double T2 = 0;
            double t1 = 0;
            double t2 = 0;
            double KW = 0;
            double f = 0;
            double GemDeltaT = 0;
            double A = 0;
            double minflow_T = 0;
            double minflow_t = 0;
            try
            {
                T1 = Convert.ToDouble(Model.Param1);
                T2 = Convert.ToDouble(Model.Param2);
                t1 = Convert.ToDouble(Model.Param3);
                t2 = Convert.ToDouble(Model.Param4);
                KW = Convert.ToDouble(Model.Param5);
            }
            catch
            {
            <script></script>
            }

            if (T1 == 0 && T2 == 0 && t1 == 0 && t2 == 0 && KW == 0) // demo waarden invullen
            {
                T1 = 80;
                T2 = 60;
                t1 = 50;
                t2 = 60;
                KW = 10;
            }


            //make calculation here

            // soortelijke warmte water = 4183 J/kg.K

            minflow_T = KW * 1000 / (4183 / 60 * (T1 - T2));
            minflow_t = KW * 1000 / (4183 / 60 * (t2 - t1));





            if (T1 - T2 == t2 - t1) { T1 = T1 + 0.0001; }

            GemDeltaT = .8 * ((T1 - t2) - (T2 - t1)) / Math.Log((T1 - t2) / (T2 - t1));
            A = KW / (5 * GemDeltaT);

            this.Url.RouteUrl(this.ViewContext.RouteData.Values);

            <table >
                <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
                <tr><td>Inlaattemperatuur warme stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param1" value="@Math.Round(@T1,0)" /></td></tr>
                <tr><td>Uitlaattemperatuur warme stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param2" value="@Math.Round(@T2,0)" /></td></tr>
                <tr><td>Inlaattemperatuur koude stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param3" value="@Math.Round(@t1,0)" /></td></tr>
                <tr><td>Uitlaattemperatuur koude stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param4" value="@Math.Round(@t2,0)" /></td></tr>
                <tr><td>Vermogen</td><td>Kilowatt (KW)</td><td><input id="Param5" value="@Math.Round(@KW,0)" /></td></tr>
                <tr><td>Gemiddelde Delta T</td><td>Graden Celcius (ºC)</td><td><input id="Param6" disabled="disabled" value="@Math.Round(@GemDeltaT,0)" /></td></tr>
                <tr><td>Warmtewisselaar oppervlakte</td><td>Vierkantemeter (m2)</td><td><input id="Param7" disabled="disabled" value="@Math.Round(@A,4)" /></td></tr>
                <tr><td>Debiet warme stroom</td><td>Liters/minuut (L/m)</td><td><input id="Param8" disabled="disabled" value="@Math.Round(@minflow_T, 1)" /></td></tr>
                <tr><td>Debiet koude stroom</td><td>Liters/minuut (L/m)</td><td><input id="Param9" disabled="disabled" value="@Math.Round(@minflow_t, 1)" /></td></tr>

            </table>


            <br />
            <input type="button" value="Opnieuw berekenen" onclick="" />

            <br />
            <br />

            <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
        }

    </div>

<div class="Berekening boiler warmtewisselaar oppervlakte warmte afname">
    @if (Model.Name == "Berekening boiler warmtewisselaar oppervlakte warmte afname")
    {
        double T1 = 0;
        double T2 = 0;
        double t1 = 0;
        double t2 = 0;
        double KW = 0;
        double f = 0;
        double GemDeltaT = 0;
        double A = 0;
        double minflow_t = 0;
        try
        {
            T1 = Convert.ToDouble(Model.Param1);
            //T2 = Convert.ToDouble(Model.Param2);
            t1 = Convert.ToDouble(Model.Param2);
            t2 = Convert.ToDouble(Model.Param3);
            KW = Convert.ToDouble(Model.Param4);
        }
        catch
        {
        <script></script>
        }

        if (T1 == 0 && T2 == 0 && t1 == 0 && t2 == 0 && KW == 0) // demo waarden invullen
        {
            T1 = 80;
            T2 = 80;
            t1 = 50;
            t2 = 60;
            KW = 10;
        }


        //make calculation here

        // soortelijke warmte water = 4183 J/kg.K

        T2 = T1;

        //minflow_T = KW * 1000 / (4183 / 60 * (T1 - T2));
        minflow_t = KW * 1000 / (4183 / 60 * (t2 - t1));





        if (T1 - T2 == t2 - t1) { T1 = T1 + 0.0001; }

        GemDeltaT = .8 * ((T1 - t2) - (T2 - t1)) / Math.Log((T1 - t2) / (T2 - t1));
        A = KW / (1.5 * GemDeltaT);

        this.Url.RouteUrl(this.ViewContext.RouteData.Values);

        <table >
            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
            <tr><td>Boiler temperatuur</td><td>Graden Celcius (ºC)</td><td><input id="Param1" value="@Math.Round(@T1,0)" /></td></tr>
            <tr><td>Inlaattemperatuur koude stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param2" value="@Math.Round(@t1,0)" /></td></tr>
            <tr><td>Uitlaattemperatuur koude stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param3" value="@Math.Round(@t2,0)" /></td></tr>
            <tr><td>Vermogen</td><td>Kilowatt (KW)</td><td><input id="Param4" value="@Math.Round(@KW,0)" /></td></tr>
            <tr><td>Gemiddelde Delta T</td><td>Graden Celcius (ºC)</td><td><input id="Param5" disabled="disabled" value="@Math.Round(@GemDeltaT,0)" /></td></tr>
            <tr><td>Warmtewisselaar oppervlakte</td><td>Vierkantemeter (m2)</td><td><input id="Param6" disabled="disabled" value="@Math.Round(@A,4)" /></td></tr>
            <tr><td>Debiet koude stroom</td><td>Liters/minuut (L/m)</td><td><input id="Param7" disabled="disabled" value="@Math.Round(@minflow_t, 1)" /></td></tr>

        </table>


        <br />
        <input type="button" value="Opnieuw berekenen" onclick="" />

        <br />
        <br />

        <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

</div>

<div class="Berekening boiler warmtewisselaar oppervlakte warmte aanvoer">
    @if (Model.Name == "Berekening boiler warmtewisselaar oppervlakte warmte aanvoer")
    {
        double T1 = 0;
        double T2 = 0;
        double t1 = 0;
        double t2 = 0;
        double KW = 0;
        double GemDeltaT = 0;
        double A = 0;
        double minflow_T = 0;
        double minflow_t = 0;
        try
        {
            T1 = Convert.ToDouble(Model.Param1);
            T2 = Convert.ToDouble(Model.Param2);
            t1 = Convert.ToDouble(Model.Param3);
            //t2 = Convert.ToDouble(Model.Param4);
            KW = Convert.ToDouble(Model.Param4);
        }
        catch
        {
        <script></script>
        }

        t2 = t1;

        if (T1 == 0 && T2 == 0 && t1 == 0 && t2 == 0 && KW == 0) // demo waarden invullen
        {
            T1 = 80;
            T2 = 50;
            t1 = 40;
            t2 = 40;
            KW = 10;
        }


        //make calculation here

        // soortelijke warmte water = 4183 J/kg.K

        minflow_T = KW * 1000 / (4183 / 60 * (T1 - T2));
        minflow_t = KW * 1000 / (4183 / 60 * (t2 - t1));





        if (T2 == t1) { T2 = T2 + 0.0001; }

        GemDeltaT = .8 * ((T1 - t2) - (T2 - t1)) / Math.Log((T1 - t2) / (T2 - t1));
        A = KW / (1.5 * GemDeltaT);

        this.Url.RouteUrl(this.ViewContext.RouteData.Values);

        <table >
            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
            <tr><td>Inlaattemperatuur warme stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param1" value="@Math.Round(@T1,0)" /></td></tr>
            <tr><td>Uitlaattemperatuur warme stroom</td><td>Graden Celcius (ºC)</td><td><input id="Param2" value="@Math.Round(@T2,0)" /></td></tr>
            <tr><td>Boiler temperatuur</td><td>Graden Celcius (ºC)</td><td><input id="Param3" value="@Math.Round(@t1,0)" /></td></tr>
            <tr><td>Vermogen</td><td>Kilowatt (KW)</td><td><input id="Param4" value="@Math.Round(@KW,0)" /></td></tr>
            <tr><td>Gemiddelde Delta T</td><td>Graden Celcius (ºC)</td><td><input id="Param5" disabled="disabled" value="@Math.Round(@GemDeltaT,0)" /></td></tr>
            <tr><td>Warmtewisselaar oppervlakte</td><td>Vierkantemeter (m2)</td><td><input id="Param6" disabled="disabled" value="@Math.Round(@A,4)" /></td></tr>
            <tr><td>Debiet warme stroom</td><td>Liters/minuut (L/m)</td><td><input id="Param7" disabled="disabled" value="@Math.Round(@minflow_T, 1)" /></td></tr>

        </table>


        <br />
        <input type="button" value="Opnieuw berekenen" onclick="" />

        <br />
        <br />

        <script asp-location="Footer">@Url.RouteUrl("Bereken", new { productId = Model.Id })</script>
    }

</div>


<div class="Berekening zonnepanelen opbrengst">
    @if (Model.Name == "Berekening zonnepanelen opbrengst")
    {
        double PaneelPiekvermogen = 0;
        double PmaxPlus = 0;
        short strings = 0;
        short PanelenPerString = 0;
        double Voc = 0;
        double Vmp = 0;
        double TC_Voc = 0;
        short Azimut = 0;
        short Helling = 0;
        double StroomPrijs = 0;

       // jscript helper variables
        double Maximumstringvermogen = 0;
        double Maximumsysteemvermogen = 0;
        double Maximumstringspanning = 0;
        double Minimumstringspanning = 0;
        double MaximumjaaropbrengsrkWh = 0;
        double MinimumjaaropbrengstkWh = 0;
        double Maximumjaaropbrengst = 0;
        double Minimumjaaropbrengst = 0;
        short Voc1=0, Voc2=0, Voc3=0, Voc4=0, Voc5=0, Voc6=0, Voc7=0, Voc8=0, Voc9=0, Voc10=0, Voc11 = 0;
        short Voc1a=0, Voc2a=0, Voc3a=0, Voc4a=0, Voc5a=0, Voc6a=0, Voc7a=0, Voc8a=0, Voc9a=0, Voc10a=0, Voc11a = 0;
         

        try
        {

            PaneelPiekvermogen = Convert.ToInt16(Model.Param1);
            
            
            PmaxPlus = Convert.ToInt16(Model.Param2);
            if (Model.Param2 == null)
            {
                PmaxPlus = 3;
            }

            
            strings = Convert.ToInt16(Model.Param3);
            PanelenPerString = Convert.ToInt16(Model.Param4);
            Voc = Convert.ToDouble(Model.Param5);
            TC_Voc = Convert.ToDouble(Model.Param6);
            Helling = Convert.ToInt16(Model.Param7);
            if (Model.Param8 == null)
            {
                Helling = 35;
            }
            Azimut = Convert.ToInt16(Model.Param8);
 
            StroomPrijs = Convert.ToDouble(Model.Param9);

            Vmp = Convert.ToDouble(Model.Param10);
        

        }
        catch
        {
            <script></script>
        }


        if (PaneelPiekvermogen == 0)
        {
            PaneelPiekvermogen = 250;
        }

 
        if (strings == 0)
        {
            strings = 2;
        }

        if (PanelenPerString == 0 )
        {
            PanelenPerString = 8;
        }

        if (Voc == 0)
        {
            Voc = 37.2;
        }

        if (TC_Voc == 0)
        {
            TC_Voc = -0.3682;
        }

        if (Azimut < 90 || Azimut > 270)
        {
            Azimut = 180;
        }

        if (Helling < 0 || Helling > 90)
        {
            Helling = 35;
        }


        if (StroomPrijs == 0 )
        {
            StroomPrijs = .22;
        }
        if (Vmp == 0)
        {
            Vmp=30.7;
        }

 
        //make calculation here

        Maximumstringspanning = PanelenPerString * Voc;
        Minimumstringspanning = PanelenPerString * Vmp;

        double PlusPCT = (100 + PmaxPlus) / 100;
        double MinPCT = (100 - PmaxPlus) / 100;


        Voc1 = Convert.ToInt16(Maximumstringspanning * PlusPCT - ((45) * TC_Voc / 100 * Maximumstringspanning));
        Voc2 = Convert.ToInt16(Maximumstringspanning * PlusPCT - ((35) * TC_Voc / 100 * Maximumstringspanning));
        Voc3 = Convert.ToInt16(Maximumstringspanning * PlusPCT - ((25) * TC_Voc / 100 * Maximumstringspanning));
        Voc4 = Convert.ToInt16(Maximumstringspanning * PlusPCT - ((15) * TC_Voc / 100 * Maximumstringspanning));
        Voc5 = Convert.ToInt16(Maximumstringspanning * PlusPCT - ((5) * TC_Voc / 100 * Maximumstringspanning));
        Voc6 = Convert.ToInt16(Maximumstringspanning * PlusPCT + ((5) * TC_Voc / 100 * Maximumstringspanning));
        Voc7 = Convert.ToInt16(Maximumstringspanning * PlusPCT + ((15) * TC_Voc / 100 * Maximumstringspanning));
        Voc8 = Convert.ToInt16(Maximumstringspanning * PlusPCT + ((25) * TC_Voc / 100 * Maximumstringspanning));
        Voc9 = Convert.ToInt16(Maximumstringspanning * PlusPCT + ((35) * TC_Voc / 100 * Maximumstringspanning));
        Voc10 = Convert.ToInt16(Maximumstringspanning * PlusPCT + ((45) * TC_Voc / 100 * Maximumstringspanning));
        Voc11 = Convert.ToInt16(Maximumstringspanning * PlusPCT + ((55) * TC_Voc / 100 * Maximumstringspanning));

        Voc1a = Convert.ToInt16(Minimumstringspanning * MinPCT - ((45) * TC_Voc / 100 * Minimumstringspanning));
        Voc2a = Convert.ToInt16(Minimumstringspanning * MinPCT - ((35) * TC_Voc / 100 * Minimumstringspanning));
        Voc3a = Convert.ToInt16(Minimumstringspanning * MinPCT - ((25) * TC_Voc / 100 * Minimumstringspanning));
        Voc4a = Convert.ToInt16(Minimumstringspanning * MinPCT - ((15) * TC_Voc / 100 * Minimumstringspanning));
        Voc5a = Convert.ToInt16(Minimumstringspanning * MinPCT - ((5) * TC_Voc / 100 * Minimumstringspanning));
        Voc6a = Convert.ToInt16(Minimumstringspanning * MinPCT + ((5) * TC_Voc / 100 * Minimumstringspanning));
        Voc7a = Convert.ToInt16(Minimumstringspanning * MinPCT + ((15) * TC_Voc / 100 * Minimumstringspanning));
        Voc8a = Convert.ToInt16(Minimumstringspanning * MinPCT + ((25) * TC_Voc / 100 * Minimumstringspanning));
        Voc9a = Convert.ToInt16(Minimumstringspanning * MinPCT + ((35) * TC_Voc / 100 * Minimumstringspanning));
        Voc10a = Convert.ToInt16(Minimumstringspanning * MinPCT + ((45) * TC_Voc / 100 * Minimumstringspanning));
        Voc11a = Convert.ToInt16(Minimumstringspanning * MinPCT + ((55) * TC_Voc / 100 * Minimumstringspanning));

        Maximumstringvermogen = PanelenPerString * PaneelPiekvermogen * (100 + PmaxPlus) / 100;
        Maximumsysteemvermogen = Maximumstringvermogen * strings;
        Maximumstringspanning = Voc1;
        Minimumstringspanning = Voc11a;
        MaximumjaaropbrengsrkWh = Maximumsysteemvermogen * .9 * GetOrientationCorrectionPV(Helling, Azimut)/100;
        MinimumjaaropbrengstkWh = PanelenPerString * PaneelPiekvermogen * strings * (100 - PmaxPlus) / 100 * .85 * GetOrientationCorrectionPV(Helling, Azimut)/100;
        Maximumjaaropbrengst = MaximumjaaropbrengsrkWh * StroomPrijs;
        Minimumjaaropbrengst = MinimumjaaropbrengstkWh * StroomPrijs;
        
        this.Url.RouteUrl(this.ViewContext.RouteData.Values);

        <script asp-location="Footer" src="/js/Chart.js"></script>
        
        <script asp-location="Footer">@PmaxPlus@Voc1@Voc2@Voc3@Voc4@Voc5@Voc6@Voc7@Voc8@Voc9@Voc10@Voc11@PmaxPlus@Voc1a@Voc2a@Voc3a@Voc4a@Voc5a@Voc6a@Voc7a@Voc8a@Voc9a@Voc10a@Voc11a@*$(document).ready(function () {

                var ctx = document.getElementById("canvas").getContext("2d");
        var linechart = new Chart(ctx).Line(lineChartData, options);

        document.getElementById('legendDiv').innerHTML = linechart.generateLegend();

        document.getElementById("Maximumstringvermogen").innerText = parseFloat("@Maximumstringvermogen").toFixed(0);
        document.getElementById("Maximumsysteemvermogen").innerText = parseFloat("@Maximumsysteemvermogen").toFixed(0);
        document.getElementById("Maximumstringspanning").innerText = parseFloat("@Maximumstringspanning").toFixed(0);
        document.getElementById("Minimumstringspanning").innerText = parseFloat("@Minimumstringspanning").toFixed(0);
        document.getElementById("MaximumjaaropbrengsrkWh").innerText = parseFloat("@MaximumjaaropbrengsrkWh").toFixed(0);
        document.getElementById("MinimumjaaropbrengstkWh").innerText = parseFloat("@MinimumjaaropbrengstkWh").toFixed(0);
        document.getElementById("Maximumjaaropbrengst").innerText = parseFloat("@Maximumjaaropbrengst").toFixed(0);
        document.getElementById("Minimumjaaropbrengst").innerText = parseFloat("@Minimumjaaropbrengst").toFixed(0);

            })*@
        var ctx = document.getElementById("canvas").getContext("2d");
        var linechart = new Chart(ctx).Line(lineChartData, options);

        document.getElementById('legendDiv').innerHTML = linechart.generateLegend();

        document.getElementById("Maximumstringvermogen").innerText = parseFloat("@Maximumstringvermogen").toFixed(0);
        document.getElementById("Maximumsysteemvermogen").innerText = parseFloat("@Maximumsysteemvermogen").toFixed(0);
        document.getElementById("Maximumstringspanning").innerText = parseFloat("@Maximumstringspanning").toFixed(0);
        document.getElementById("Minimumstringspanning").innerText = parseFloat("@Minimumstringspanning").toFixed(0);
        document.getElementById("MaximumjaaropbrengsrkWh").innerText = parseFloat("@MaximumjaaropbrengsrkWh").toFixed(0);
        document.getElementById("MinimumjaaropbrengstkWh").innerText = parseFloat("@MinimumjaaropbrengstkWh").toFixed(0);
        document.getElementById("Maximumjaaropbrengst").innerText = parseFloat("@Maximumjaaropbrengst").toFixed(0);
        document.getElementById("Minimumjaaropbrengst").innerText = parseFloat("@Minimumjaaropbrengst").toFixed(0);
    }
        </script>

  
    
        <table >

        <tr style="font-weight:bold;">
            <td colspan="3">Invulgegevens:</td>
        </tr>

        <tr style="font-weight:bold;">
            <td>Naam</td>
            <td>Eenheid</td>
            <td>Waarde</td>
        </tr>

        <tr>
            <td>Paneel piekvermogen</td>
            <td>Wp</td>
            <td><input id="Param1" value="@PaneelPiekvermogen" /></td>
        </tr>

        <tr>
            <td>Paneel vermogenstolerantie Pmax(+)</td>
            <td>%</td>
            <td><input id="Param2" value="@PmaxPlus" /></td>
        </tr>

        <tr>
            <td>Aantal strings (sets van in serie geschakelde panelen)</td>
            <td>#</td>
            <td><input id="Param3" value="@strings" /></td>
        </tr>

        <tr>
            <td>Aantal panelen per string</td>
            <td>#</td>
            <td><input id="Param4" value="@PanelenPerString" /></td>
        </tr>

        <tr>
            <td>Paneel openklemspanning - Voc</td>
            <td>V</td>
            <td><input id="Param5" value="@Math.Round(@Voc,2)" /></td>
        </tr>

        <tr>
                <td>Paneel Maximum Power Point spanning - Vmp</td>
                <td>V</td>
                <td><input id="Param10" value="@Math.Round(@Vmp,2)" /></td>
        </tr>


        <tr>
            <td>Paneel openklemspanning temperatuursafhankelijkheid - TC Voc</td>
            <td>%/ºC</td>
            <td><input id="Param6" value="@Math.Round(@TC_Voc,4)" /></td>
        </tr>

        <tr>
            <td>Paneel helling (van 0º tot 90º)</td>
            <td>Graden</td>
            <td><input id="Param7" value="@Helling" /></td>
        </tr>

        <tr>
            <td>Paneel richting (Azimut van 90º tot 270º)</td>
            <td>Graden</td>
            <td><input id="Param8" value="@Azimut" /></td>
        </tr>

        <tr>
            <td>Stroom prijs per kWh</td>
            <td>€</td>
            <td><input id="Param9" value="@Math.Round(@StroomPrijs, 2)" /></td>
        </tr>

    </table>

    <br />
  
               
        <table >
            <tr style="font-weight:bold;"><td colspan="3">Resultaten:</td></tr>
            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
            <tr><td>Maximum string vermogen ( Dit vermogen moet de omvormer-stringingang aan kunnen)</td><td>Watt</td><td><div id="Maximumstringvermogen"></div></td></tr>
            <tr><td>Maximum systeem vermogen (Dit vermogen moet de omvormer aan kunnen)</td><td>Watt</td><td><div id="Maximumsysteemvermogen"></div></td></tr>
            <tr><td>Maximum string spanning bij -20ºC (maximale ingangsspanning voor omvormer)</td><td>Volt</td><td><div id="Maximumstringspanning"></div></td></tr>
            <tr><td>Minimum string spanning bij 80ºC (minimale ingangsspanning voor omvormer)</td><td>Volt</td><td><div id="Minimumstringspanning"></div></td></tr>
            <tr><td>Maximum jaaropbrengst kWh [Wp x Pmax(+) x 0.9 * orientatiecorrectie]</td><td>kWh</td><td><div id="MaximumjaaropbrengsrkWh"></div></td></tr>
            <tr><td>Minimum jaaropbrengst kWh [Wp x Pmax(-) x 0.85 * orientatiecorrectie]</td><td>kWh</td><td><div id="MinimumjaaropbrengstkWh"></div></td></tr>
            <tr><td>Maximum jaaropbrengst € (uitgaande van 100% saldering)</td><td>€</td><td><div id="Maximumjaaropbrengst"></div></td></tr>
            <tr><td>Minimum jaaropbrengst € (uitgaande van 100% saldering)</td><td>€</td><td><div id="Minimumjaaropbrengst"></div></td></tr> 
         </table>



    <table height="350" style="width:100%">
        <tr><td><div id="legendDiv"></div></td></tr>
        <tr><td><canvas id="canvas"></canvas></td></tr>
    </table>


        <br />

    <input type="button" value="Opnieuw berekenen" onclick="MakeUrl()" />

    <br />
    <br />
             <script asp-location="Footer">

            function MakeUrl() {

                var myurl = '@Url.RouteUrl("Bereken", new { productId = Model.Id })';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
        </script>
        }

</div>

<div class="Berekening GJoule en kWh">
    @if (Model.Name == "Berekening GJoule en kWh")
    {
        double GJoule = 0;
        double kWh = 0;
        string GJkWhKeuze = "";
        try
        {
            GJoule = Convert.ToDouble(Model.Param1);
            kWh = Convert.ToDouble(Model.Param2);
            GJkWhKeuze = Model.Param3.TrimEnd();
        }
        catch
        {
         }

        if (GJoule == 0 && kWh == 0) // demo waarden invullen
        {
            GJoule = 1;
            kWh = GJoule * 1000000000 / 3600 / 1000;
        }

        //make calculation here
        if (GJkWhKeuze == "kWh")
        {
            kWh = GJoule * 1000000000 / 3600 / 1000;

        }

        if (GJkWhKeuze == "GJ")
        {
            GJoule = kWh * 1000 * 3600 / 1000000000;
        }

        this.Url.RouteUrl(this.ViewContext.RouteData.Values);

         <br />


        <table >
            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
            <tr><td>Giga-Joule</td><td>GJ</td><td><input id="Param1" value="@Math.Round(@GJoule,2)" /></td></tr>
            <tr><td>kilowatt-uur</td><td>kWh</td><td><input id="Param2" disabled="disabled" value="@Math.Round(@kWh,2)" /></td></tr>

        </table>
        <br />
        <input type="button" value="Bereken kWh" onclick="MakeUrlTokWh()" />

        <br />    <br />    <br />

        <table >
            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
            <tr><td>kilowatt-uur</td><td>kWh</td><td><input id="Param2a" value="@Math.Round(@kWh,2)" /></td></tr>
            <tr><td>Giga-Joule</td><td>GJ</td><td><input id="Param1a" disabled="disabled" value="@Math.Round(@GJoule,2)" /></td></tr>
        </table>
        <br />
        <input type="button" value="Bereken GJoule" onclick="MakeUrlToGJoule()" />


        <br />
        <br />

        <script asp-location="Footer">

            function MakeUrlTokWh() {

                var myurl = '@Url.RouteUrl("Bereken", new { productId = Model.Id })';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=kWh"; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }

            function MakeUrlToGJoule() {

                var myurl = '@Url.RouteUrl("Bereken", new { productId = Model.Id })';

                try { myurl += "?Param1=" + document.getElementById('Param1a').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2a').value; } catch (e) { }
                try { myurl += "&Param3=GJ"; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }

        </script>
    }

</div>


<div class="Berekening collector piekvermogen en minimaal debiet">
    @if (Model.Name == "Berekening collector piekvermogen en minimaal debiet")
    {
        double Apertuur = 0;
        double rendement = 0;
        string vloeistof = "";
        double delta_t = 0;
        double P_max = 0;
        double Minflow = 0;
        try
        {
            Apertuur = Convert.ToDouble(Model.Param1);
            rendement = Convert.ToDouble(Model.Param2);
            vloeistof = Convert.ToString(Model.Param3);
            delta_t = Convert.ToDouble(Model.Param4);
        }
        catch
        {
        <script>alert("gebruik een getal met een komma als decimaal scheidingsteken")            </script>
        }

        if (Apertuur == 0)
        {
            Apertuur = 3.28;
        }
        if (rendement == 0)
        {
            rendement = 0.668;
        }
        if (delta_t == 0)
        {
            delta_t = 15;
        }

        if (vloeistof == null)
        {
            vloeistof = "Water/antivries 60/40%";
        }

        //make calculation here


        P_max = Apertuur * rendement * 1000; // instraling nederland max 1000 w/m2

        double vermogeninjoulesperminuut = P_max * 60;

        if (vloeistof == "Water/antivries 60/40%")
        {
            double KGnodigbijdeltaT = vermogeninjoulesperminuut / 3600 / delta_t;
            Minflow = KGnodigbijdeltaT / 1.014;
        }
        if (vloeistof == "Water")
        {
            Minflow = vermogeninjoulesperminuut / 4183 / delta_t;
        }





        this.Url.RouteUrl(this.ViewContext.RouteData.Values);

        <table >
            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>
            <tr><td>Collector apertuur (netto oppervlakte)</td><td>m2</td><td><input id="Param1" value="@Math.Round(@Apertuur,2)" /></td></tr>
            <tr><td>Collector rendement of conversiefactor</td><td>η</td><td><input id="Param2" value="@Math.Round(@rendement,3)" /></td></tr>
            <tr><td>Vloeistof medium</td><td>type</td>
            <td>
                <select id="Param3">
                    <option selected='@(vloeistof == "Water/antivries 60/40%" ? "selected" : "")'>Water/antivries 60/40%</option>
                    <option selected='@(vloeistof == "Water" ? "selected" : "")'>Water</option>
                </select>
             </td>
             </tr>
            <tr><td>Collector maximum delta-T</td><td>ºC</td><td><input id="Param4" value="@Math.Round(@delta_t,0)" /></td></tr>
            <tr><td>Collector piekvermogen</td><td>Wp</td><td><input id="Param5" disabled="disabled" value="@Math.Round(@P_max, 0)" /></td></tr>
            <tr><td>Minimaal debiet in liters/minuut</td><td>L/m</td><td><input id="Param6" disabled="disabled" value="@Math.Round(@Minflow,1)" /></td></tr>

        </table>


        <br />
        <input type="button" value="Opnieuw berekenen" onclick="MakeUrl()" />

        <br />
        <br />

        <script asp-location="Footer">

            function MakeUrl() {

                var myurl = '@Url.RouteUrl("Bereken", new { productId = Model.Id })';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
        </script>
    }

</div>


<div class="Berekening circuit weerstand en pomp vermogen">
    @if (Model.Name == "Berekening circuit weerstand en pomp vermogen")
    {
        string lijdingtype = "";
        string leidingDN = "";
        short leidinglengte = 0;
        string vloeistof = "";
        short aantalbochten = 0;
        short warmtewisselaar = 0;
        short collector = 0;
        short pompgroep = 0;
        double Flow = 0;
        double VerliesPas = 0;
        double VerliesBar = 0;

        try
        {
            lijdingtype = Convert.ToString(Model.Param1);
            leidingDN = Convert.ToString(Model.Param2);
            leidinglengte = Convert.ToInt16(Model.Param3);
            vloeistof = Convert.ToString(Model.Param4);
            aantalbochten = Convert.ToInt16(Model.Param5);
            warmtewisselaar = Convert.ToInt16(Model.Param6);
            collector = Convert.ToInt16(Model.Param7);
            pompgroep = Convert.ToInt16(Model.Param8);
            Flow = Convert.ToDouble(Model.Param9);
        }
        catch
        {
            <script>alert("gebruik een getal met een komma als decimaal scheidingsteken")            </script>

        }

        if (leidinglengte == 0) { leidinglengte = 20; }
        if (leidingDN == null) { leidingDN = "DN16"; }
        if (vloeistof == null) { vloeistof = "Water/antivries 60/40%"; }
        if (warmtewisselaar == 0) { warmtewisselaar = 500; }
        if (collector == 0) { collector = 2000; }
        if (pompgroep == 0) { pompgroep = 500; }
        if (aantalbochten == 0) { aantalbochten = 10; }
        if (Flow == 0) { Flow = 5; }

        //		                        Antivries	Water	Inhoud	Bocht/kopp
        //Koper & RVS Flex*	Max flow	Pa/meter	Pa/meter	L/meter	Pa/stuk
        //DN 12	             5 l/m	      350	      40	      0.11	  35
        //DN 16	            10 l/m	      112	      15	      0.20	  11
        //DN 20	            15 l/m	      45	       3	      0.31	  5
        //DN 25	            20 l/m	      18	       1	      0.49	  2


        //make calculation here

        string MaxFlow = "";
        string PaLeiding = "";
        string PaBocht = "";



        if (vloeistof == "Water/antivries 60/40%")
        {

            if (leidingDN == "DN12")
            {
                MaxFlow = GetPa(1, 1);
                PaLeiding = GetPa(1, 2);
                PaBocht = GetPa(1, 5);
            }

            if (leidingDN == "DN16")
            {
                MaxFlow = GetPa(2, 1);
                PaLeiding = GetPa(2, 2);
                PaBocht = GetPa(2, 5);
            }
            if (leidingDN == "DN20")
            {
                MaxFlow = GetPa(3, 1);
                PaLeiding = GetPa(3, 2);
                PaBocht = GetPa(3, 5);
            }
            if (leidingDN == "DN25")
            {
                MaxFlow = GetPa(4, 1);
                PaLeiding = GetPa(4, 2);
                PaBocht = GetPa(4, 5);
            }
        }

        if (vloeistof == "Water")
        {

            if (leidingDN == "DN12")
            {
                MaxFlow = GetPa(1, 1);
                PaLeiding = GetPa(1, 3);
                PaBocht = GetPa(1, 5);
            }

            if (leidingDN == "DN16")
            {
                MaxFlow = GetPa(2, 1);
                PaLeiding = GetPa(2, 3);
                PaBocht = GetPa(2, 5);
            }
            if (leidingDN == "DN20")
            {
                MaxFlow = GetPa(3, 1);
                PaLeiding = GetPa(3, 3);
                PaBocht = GetPa(3, 5);
            }
            if (leidingDN == "DN25")
            {
                MaxFlow = GetPa(4, 1);
                PaLeiding = GetPa(4, 3);
                PaBocht = GetPa(4, 5);
            }
        }

        VerliesPas = leidinglengte * Convert.ToDouble(PaLeiding) * Flow + aantalbochten * Convert.ToDouble(PaBocht) + warmtewisselaar + collector + pompgroep;
        VerliesBar = VerliesPas / 100 / 1000;

        this.Url.RouteUrl(this.ViewContext.RouteData.Values);


        <table >

            <tr style="font-weight:bold;"><td>Naam</td><td>Eenheid</td><td>Waarde</td></tr>

            <tr><td>Leiding soort</td><td></td>
                <td>
                    <select id="Param1">
                        <option selected='@(lijdingtype == "Golfbuis RVS" ? "selected" : "")'>Golfbuis RVS</option>
                    </select>

                </td>
            </tr>

            <tr><td>Leiding binnendiameter in mm</td><td>DN</td>
                <td>
                      <select id="Param2">
                            <option selected='@(leidingDN == "DN12" ? "selected" : "")'>DN12</option>
                            <option selected='@(leidingDN == "DN16" ? "selected" : "")'>DN16</option>
                            <option selected='@(leidingDN == "DN20" ? "selected" : "")'>DN20</option>
                            <option selected='@(leidingDN == "DN25" ? "selected" : "")'>DN25</option>
                      </select>
                </td>
            </tr>



 
            <tr><td>Vloeistof soort</td><td></td><td>
                
                    <select id="Param4">
                        <option selected='@(vloeistof == "Water/antivries 60/40%" ? "selected" : "")'>Water/antivries 60/40%</option>
                        <option selected='@(vloeistof == "Water" ? "selected" : "")'>Water</option>
                    </select>
               
                </td></tr>

            <tr><td>Leiding lengte in meters</td><td>m</td><td><input id="Param3" value="@leidinglengte" /></td></tr>
            
            <tr><td>Aantal bochten</td><td>#</td><td><input id="Param5" value="@aantalbochten" /></td></tr>

            <tr><td>Warmtewisselaar drukverlies in Pascal</td><td>Pa</td><td><input id="Param6" value="@warmtewisselaar" /></td></tr>

            <tr><td>Collector(en) drukverlies in Pascal</td><td>Pa</td><td><input id="Param7" value="@collector" /></td></tr>

            <tr><td>Pompgroep drukverlies</td><td>Pa</td><td><input id="Param8" value="@pompgroep" /></td></tr>

            <tr><td>Flow in liters per minuut</td><td>l/min</td><td><input id="Param9" value="@Flow" /></td></tr>

            <tr><td>Totaal drukverlies in Pascal</td><td>Pa</td><td><input  disabled="disabled" value="@Math.Round(@VerliesPas, 0)" /></td></tr>

            <tr><td>Totaal drukverlies in Bar</td><td>B</td><td><input disabled="disabled" value="@Math.Round(@VerliesBar, 4)" /></td></tr>

            <tr><td>Maximum flow in liters/minuut</td><td>l/min</td><td><input disabled="disabled" value="@MaxFlow" /></td></tr>

            <tr><td>Minimale  opvoerhoogte circulatiepomp in meters</td><td>m</td><td><input disabled="disabled" value="@Math.Round(@VerliesBar * 10, 4)" /></td></tr>

        </table>


        <br />
        <input type="button" value="Opnieuw berekenen" onclick="MakeUrl()" />

        <br />
        <br />

        <script asp-location="Footer">

            function MakeUrl() {

                var myurl = '@Url.RouteUrl("Bereken", new { productId = Model.Id })';

                try { myurl += "?Param1=" + document.getElementById('Param1').value; } catch (e) { }
                try { myurl += "&Param2=" + document.getElementById('Param2').value; } catch (e) { }
                try { myurl += "&Param3=" + document.getElementById('Param3').value; } catch (e) { }
                try { myurl += "&Param4=" + document.getElementById('Param4').value; } catch (e) { }
                try { myurl += "&Param5=" + document.getElementById('Param5').value; } catch (e) { }
                try { myurl += "&Param6=" + document.getElementById('Param6').value; } catch (e) { }
                try { myurl += "&Param7=" + document.getElementById('Param7').value; } catch (e) { }
                try { myurl += "&Param8=" + document.getElementById('Param8').value; } catch (e) { }
                try { myurl += "&Param9=" + document.getElementById('Param9').value; } catch (e) { }
                try { myurl += "&Param10=" + document.getElementById('Param10').value; } catch (e) { }

                //alert(myurl);

                window.location.assign(myurl);

            }
        </script>
    }

</div>


    <div class="Functions">

        @functions{

            public double GetWaterExpansion(int T)
            {
                double[] waterexpansion = new double[101];
                waterexpansion[0] = -0.153027544958107;
                waterexpansion[1] = -0.160017601936218;
                waterexpansion[2] = -0.165009900594043;
                waterexpansion[3] = -0.169003380067608;
                waterexpansion[4] = -0.170999999999992;
                waterexpansion[5] = -0.170999999999992;
                waterexpansion[6] = -0.170001700017011;
                waterexpansion[7] = -0.167006680267221;
                waterexpansion[8] = -0.16201458131232;
                waterexpansion[9] = -0.156023403510531;
                waterexpansion[10] = -0.148034047831004;
                waterexpansion[11] = -0.139044494238149;
                waterexpansion[12] = -0.129054202765161;
                waterexpansion[13] = -0.117063214135641;
                waterexpansion[14] = -0.104069726716901;
                waterexpansion[15] = -0.0900729590968723;
                waterexpansion[16] = -0.0740718496942065;
                waterexpansion[17] = -0.0570650541617539;
                waterexpansion[18] = -0.0390515480434175;
                waterexpansion[19] = -0.0200302456709665;
                waterexpansion[20] = 0;
                waterexpansion[21] = 0.0210403975633255;
                waterexpansion[22] = 0.0430922173451052;
                waterexpansion[23] = 0.067159840420203;
                waterexpansion[24] = 0.0912390463013111;
                waterexpansion[25] = 0.116333878230506;
                waterexpansion[26] = 0.143450434363899;
                waterexpansion[27] = 0.170581683540874;
                waterexpansion[28] = 0.198733325972839;
                waterexpansion[29] = 0.227907070139153;
                waterexpansion[30] = 0.259111588715584;
                waterexpansion[31] = 0.289328015591565;
                waterexpansion[32] = 0.321578952657546;
                waterexpansion[33] = 0.354859463589193;
                waterexpansion[34] = 0.38816206268919;
                waterexpansion[35] = 0.423507162401407;
                waterexpansion[36] = 0.458877159791896;
                waterexpansion[37] = 0.495283731137434;
                waterexpansion[38] = 0.532729103726084;
                waterexpansion[39] = 0.570202391626282;
                waterexpansion[40] = 0.608717561098501;
                waterexpansion[41] = 0.648276974573008;
                waterexpansion[42] = 0.688883061343873;
                waterexpansion[43] = 0.730538317945602;
                waterexpansion[44] = 0.772228054590968;
                waterexpansion[45] = 0.814970410615828;
                waterexpansion[46] = 0.857749040210138;
                waterexpansion[47] = 0.902603703404225;
                waterexpansion[48] = 0.947498280952956;
                waterexpansion[49] = 0.993454530739427;
                waterexpansion[50] = 1.03945264265906;
                waterexpansion[51] = 1.08651626230305;
                waterexpansion[52] = 1.13464830967793;
                waterexpansion[53] = 1.1828262147534;
                waterexpansion[54] = 1.23207658141847;
                waterexpansion[55] = 1.28240247552375;
                waterexpansion[56] = 1.33277843192985;
                waterexpansion[57] = 1.38423415189;
                waterexpansion[58] = 1.43574215574702;
                waterexpansion[59] = 1.4893660282217;
                waterexpansion[60] = 1.54201377233936;
                waterexpansion[61] = 1.59678404233665;
                waterexpansion[62] = 1.65161342877798;
                waterexpansion[63] = 1.70650202742628;
                waterexpansion[64] = 1.76248725790009;
                waterexpansion[65] = 1.81957264521392;
                waterexpansion[66] = 1.87672211450148;
                waterexpansion[67] = 1.93497661690525;
                waterexpansion[68] = 1.99329777886757;
                waterexpansion[69] = 2.05272896412836;
                waterexpansion[70] = 2.1132739379929;
                waterexpansion[71] = 2.17389079371577;
                waterexpansion[72] = 2.23457965938533;
                waterexpansion[73] = 2.29638890027462;
                waterexpansion[74] = 2.35932245098844;
                waterexpansion[75] = 2.42233348381006;
                waterexpansion[76] = 2.48542214191852;
                waterexpansion[77] = 2.55069545744047;
                waterexpansion[78] = 2.61499717325384;
                waterexpansion[79] = 2.68043569937156;
                waterexpansion[80] = 2.747015232606;
                waterexpansion[81] = 2.81368116419662;
                waterexpansion[82] = 2.88149392474723;
                waterexpansion[83] = 2.94939619878517;
                waterexpansion[84] = 3.01845125072235;
                waterexpansion[85] = 3.0875990045333;
                waterexpansion[86] = 3.15790561416924;
                waterexpansion[87] = 3.22830818865232;
                waterexpansion[88] = 3.29880692459723;
                waterexpansion[89] = 3.37047238387143;
                waterexpansion[90] = 3.44330922429694;
                waterexpansion[91] = 3.51624878160062;
                waterexpansion[92] = 3.58929127321778;
                waterexpansion[93] = 3.66351335915516;
                waterexpansion[94] = 3.73891989067971;
                waterexpansion[95] = 3.813356627358;
                waterexpansion[96] = 3.89006254487934;
                waterexpansion[97] = 3.96688189960423;
                waterexpansion[98] = 4.04381494335533;
                waterexpansion[99] = 4.12086192870105;
                waterexpansion[100] = 4.20019831950316;
                return waterexpansion[T];
            }



            public Int16 GetOrientationCorrection(Int16 Helling, Int16 Azimut, Int16 Month)
            {
                Int16[,] corrtable = new Int16[10, 13] {
                    {90,90,90,90,90,90,90,90,90,90,90,90,90},
                    {89,91,92,94,95,95,96,95,95,94,93,91,90},
                    {87,90,93,96,97,98,98,98,97,96,94,91,88},
                    {86,89,93,96,98,99,100,100,98,96,94,90,86},
                    {82,86,90,95,97,99,100,99,98,96,92,88,84},
                    {78,84,88,92,95,96,97,97,96,93,89,85,80},
                    {74,79,84,87,90,91,93,93,92,89,86,81,76},
                    {69,74,78,82,85,86,87,87,86,84,80,76,70},
                    {63,68,72,75,77,79,80,80,79,77,74,69,65},
                    {56,60,64,67,69,71,71,71,71,69,65,62,58}
                };

                Int16[,] corrtable2 = new Int16[12, 13] { // pct correction per month on top of correction table for year

                
                   {40,30,20,15,10,5,0,5,10,15,20,30,40},
                   {30,20,15,10,5,0,0,0,5,10,15,20,30},
                   {20,15,10,5,0,0,0,0,0,5,10,15,20},
                   {15,10,5,0,0,0,0,0,0,0,5,10,15},
                   {0,0,0,0,0,0,0,0,0,0,0,0,0},
                   {0,0,0,0,0,0,0,0,0,0,0,0,0},
                   {0,0,0,0,0,0,0,0,0,0,0,0,0},
                   {0,0,0,0,0,0,0,0,0,0,0,0,0},
                   {15,10,5,0,0,0,0,0,0,0,5,10,15},
                   {20,15,10,5,0,0,0,0,0,5,10,15,20},
                   {30,20,15,10,5,0,0,0,5,10,15,20,30},
                   {40,30,20,15,10,5,0,5,10,15,20,30,40}
                };
                
                double tmp = 0;

                tmp = Helling / 10;
                tmp = Math.Round(tmp);
                Int16 HellingIdx = Convert.ToInt16(tmp);
                Int16 resultcorrection;
                Int16 resultcorrection2;
                
                if (Azimut >= 90 && Azimut <= 270)
                {
                    tmp = (Azimut - 270) / 15;
                    tmp = Math.Round(tmp);
                    Int16 AzimutIdx = Convert.ToInt16(tmp);
                    resultcorrection = corrtable[HellingIdx, Math.Abs(AzimutIdx)];
                    resultcorrection2 = corrtable2[Month-1, Math.Abs(AzimutIdx)];// Extra correction per month instead of per year as first table is

                    return Convert.ToInt16(resultcorrection * (100-resultcorrection2)/100);
                }
                else { return 100; }

            }

            public Int16 GetOrientationCorrectionPV(Int16 Helling, Int16 Azimut)
            {
                Int16[,] corrtable = new Int16[10, 13] {
                    {87,87,87,87,87,87,87,87,87,87,87,87,87},
                    {89,91,92,94,95,95,96,95,95,94,93,91,90},
                    {87,90,93,96,97,98,98,98,97,96,93,91,88},
                    {86,89,93,96,98,99,100,100,98,96,93,90,86},
                    {82,86,90,95,98,99,100,100,98,96,91,88,84},
                    {78,84,88,92,95,96,97,97,96,93,86,85,80},
                    {74,79,84,87,90,91,93,93,92,89,83,81,78},
                    {69,74,78,82,85,86,87,87,86,84,77,76,70},
                    {63,68,72,75,78,79,80,80,79,77,71,69,65},
                    {56,60,64,67,69,71,71,71,71,69,63,62,58}
                };

                double tmp = 0;

                tmp = Helling / 10;
                tmp = Math.Round(tmp);
                Int16 HellingIdx = Convert.ToInt16(tmp);

                if (Azimut >= 90 && Azimut <= 270)
                {
                    tmp = (Azimut - 270) / 15;
                    tmp = Math.Round(tmp);
                    Int16 AzimutIdx = Convert.ToInt16(tmp);
                    return corrtable[HellingIdx, Math.Abs(AzimutIdx)];
                }
                else { return 100; }

            }


            //		                        Antivries	Water	Inhoud	Bocht/kopp
            //Koper & RVS Flex*	Max flow	Pa/meter	Pa/meter	L/meter	Pa/stuk
            //DN 12	             5 l/m	      350	      40	      0.11	  35
            //DN 16	            10 l/m	      112	      15	      0.20	  11
            //DN 20	            15 l/m	      45	       3	      0.31	  5
            //DN 25	            20 l/m	      18	       1	      0.49	  2


            public String GetPa(Int16 DN, Int16 Param)
            {
                string[,] mTable = new string[4, 5] {
                    {"5","350","40","0.11","35"},
                    {"10","112","15","0.20","11"},
                    {"15","45","3","0.31","5"},
                    {"20","18","1","0.49","2"}
                };

                return mTable[DN - 1, Param - 1];

            }


            public double GetCollectorInfo(int Collector, int Param)
            {
                // n0,a1,a2,Apertuur,boilerL,pompW,boilerrend,boilerverlies,subsidie,iam
                string[,] mTable  = {
                    {"Prisma Pro","0.668","1.496","0.005","0.1822","0", "0","0","0","0","1"},
                    {"Kingspan Heatpipe","0.78","2.112","0.006","0.105","0","0","0","0","0","0.97"},
                    {"Kingspan Direct Flow","0.783","1.061","0.023","0.105","0","0","0","0","0","0.97"},
                    {"4Plus Vlakkeplaat","0.8","4.403","0.009","2.35","0","0","0","0","0","0.94"},
                    {"2Plus Vlakkeplaat","0.8","4.403","0.009","1.89","0","0","0","0","0","0.94"},
                    {"Ensol PVT","0.481","4.57","0.014","1.86","0","0","0","0","0","0.94"},
                    {"Sunrain TZ58/1800","0.734","1.529","0.016","0.093","0","0","0","0","0","1"},
                    {"TVP","0.737","0.504","0.006","1.96","0","0","0","0","0","0.94"}
               };
                // get a temporary culture (clone) to modify
                var ci = CultureInfo.InvariantCulture.Clone() as CultureInfo;
                ci.NumberFormat.NumberDecimalSeparator = ".";
 
                return Convert.ToDouble(decimal.Parse(mTable[Collector - 1, Param - 1],ci));

            }

            public double GetMonthInfo(int Month, int Param, int Helling, string Azimut)
            {
 /*               string[,] mTable = { // maanddagen,gem temp,zonuren,gem instraling)  
                    {"jan","31","2.8","5.3","40"},
                    {"feb","29","2.6","5.7","65"},
                    {"mar","31","7.4","7.6","126"},
                    {"apr","30","12.2","9.5","167"},
                    {"mei","31","16.3","10.3","193"},
                    {"jun","30","19.8","11.2","209"},
                    {"jul","31","21","11.2","187"},
                    {"aug","31","22","11","206"},
                    {"sep","30","17","10.1","139"},
                    {"oct","31","11.9","7.3","94"},
                    {"nov","30","5.6","5.3","51"},
                    {"dec","31","3.2","4.5","33"}
                }; */

                // oost 90 graden
                string[,] oost = 
                { // maanddagen,gem temp,zonuren,gem instraling bij 0,5,10......85,90 graden helling)  
                    {"Jan","31","3.8","8","683.870967741935","683.870967741935","683.870967741935","683.870967741935","683.870967741935","683.870967741935","680.645161290323","677.41935483871","670.967741935484","661.290322580645","648.387096774194","635.483870967742","619.354838709677","600","577.41935483871","554.838709677419","532.258064516129","503.225806451613","474.193548387097"},
                    {"Feb","29","4.3","10","1196.55172413793","1196.55172413793","1193.10344827586","1189.65517241379","1189.65517241379","1186.20689655172","1175.86206896552","1165.51724137931","1151.72413793103","1134.48275862069","1110.34482758621","1082.75862068966","1051.72413793103","1017.24137931034","975.862068965517","937.931034482759","889.655172413793","844.827586206897","796.551724137931"},
                    {"Mar","31","7.1","12","2622.58064516129","2616.12903225806","2609.67741935484","2596.77419354839","2583.87096774194","2561.29032258065","2541.93548387097","2509.67741935484","2470.96774193548","2425.8064516129","2370.96774193548","2306.45161290323","2232.25806451613","2151.61290322581","2061.29032258064","1964.51612903226","1867.74193548387","1758.06451612903","1645.16129032258"},
                    {"Apr","30","11.1","15","4300","4300","4300","4266.66666666667","4233.33333333333","4200","4166.66666666667","4100","4033.33333333333","3966.66666666667","3866.66666666667","3766.66666666667","3666.66666666667","3533.33333333333","3366.66666666667","3216.66666666667","3046.66666666667","2870","2683.33333333333"},
                    {"May","31","14.5","16","4935.48387096774","4935.48387096774","4903.22580645161","4870.96774193548","4838.70967741936","4774.1935483871","4709.67741935484","4645.16129032258","4548.38709677419","4451.61290322581","4322.58064516129","4193.54838709677","4032.25806451613","3870.96774193548","3709.67741935484","3516.12903225806","3322.58064516129","3103.22580645161","2890.32258064516"},
                    {"Jun","30","17.2","17","5333.33333333333","5300","5300","5233.33333333333","5200","5133.33333333333","5033.33333333333","4933.33333333333","4833.33333333333","4733.33333333333","4566.66666666667","4433.33333333333","4266.66666666667","4066.66666666667","3866.66666666667","3666.66666666667","3466.66666666667","3220","2993.33333333333"},
                    {"Jul","31","18.9","16","5064.51612903226","5032.25806451613","5032.25806451613","4967.74193548387","4935.48387096774","4870.96774193548","4774.1935483871","4709.67741935484","4612.90322580645","4483.87096774193","4354.83870967742","4193.54838709677","4032.25806451613","3870.96774193548","3677.41935483871","3483.87096774194","3258.06451612903","3061.29032258065","2845.16129032258"},
                    {"Aug","31","18.8","15","4225.8064516129","4193.54838709677","4193.54838709677","4161.29032258064","4096.77419354839","4064.51612903226","4000","3935.48387096774","3838.70967741935","3774.1935483871","3645.16129032258","3548.38709677419","3419.35483870968","3258.06451612903","3112.90322580645","2951.61290322581","2780.64516129032","2603.22580645161","2422.58064516129"},
                    {"Sep","30","16.2","13","3016.66666666667","3010","2996.66666666667","2980","2956.66666666667","2933.33333333333","2900","2860","2813.33333333333","2753.33333333333","2683.33333333333","2606.66666666667","2520","2423.33333333333","2320","2206.66666666667","2090","1963.33333333333","1833.33333333333"},
                    {"Oct","31","12.5","11","1758.06451612903","1754.83870967742","1751.61290322581","1745.16129032258","1738.70967741936","1725.8064516129","1712.90322580645","1693.54838709677","1670.96774193548","1641.93548387097","1606.45161290323","1564.51612903226","1516.12903225806","1461.29032258065","1406.45161290323","1341.93548387097","1270.96774193548","1203.22580645161","1129.03225806452"},
                    {"Nov","30","8.1","9","796.666666666667","796.666666666667","796.666666666667","793.333333333333","793.333333333333","793.333333333333","790","783.333333333333","773.333333333333","760","746.666666666667","730","710","686.666666666667","660","633.333333333333","603.333333333333","570","540"},
                    {"Dec","31","4.3","7","519.354838709677","519.354838709677","519.354838709677","519.354838709677","519.354838709677","519.354838709677","519.354838709677","516.129032258065","509.677419354839","503.225806451613","493.548387096774","483.870967741936","470.967741935484","458.064516129032","441.935483870968","422.58064516129","406.451612903226","383.870967741936","364.516129032258"},
                };

                // zuidoost 135 graden
                string[,] zuidoost = 
                { // maanddagen,gem temp,zonuren,gem instraling bij 0,5,10......85,90 graden helling)  
                    {"Jan","31","3.8","8","710","770","830","880","930","980","1020","1050","1080","1110","1120","1130","1140","1140","1130","1110","1090","1060","1030"},
                    {"Feb","29","4.3","10","1310","1390","1460","1530","1590","1640","1680","1720","1750","1760","1770","1770","1760","1740","1700","1660","1610","1550","1490"},
                    {"Mar","31","7.1","12","2700","2810","2920","3010","3090","3150","3200","3230","3240","3240","3220","3190","3130","3060","2980","2870","2760","2620","2480"},
                    {"Apr","30","11.1","15","4370","4490","4590","4680","4750","4800","4830","4840","4820","4780","4710","4620","4500","4360","4190","4010","3810","3590","3350"},
                    {"May","31","14.5","16","5040","5100","5150","5180","5190","5180","5160","5110","5040","4940","4820","4680","4510","4330","4120","3900","3660","3410","3150"},
                    {"Jun","30","17.2","17","5450","5490","5510","5520","5500","5470","5410","5330","5230","5110","4960","4800","4610","4390","4170","3920","3660","3380","3110"},
                    {"Jul","31","18.9","16","5160","5210","5240","5260","5250","5230","5180","5110","5030","4920","4780","4630","4450","4260","4040","3810","3570","3320","3040"},
                    {"Aug","31","18.8","15","4280","4370","4440","4490","4530","4540","4540","4510","4470","4400","4310","4200","4070","3920","3750","3560","3360","3140","2910"},
                    {"Sep","30","16.2","13","3110","3220","3310","3400","3460","3520","3550","3570","3570","3550","3520","3460","3390","3300","3190","3060","2920","2770","2600"},
                    {"Oct","31","12.5","11","1830","1930","2030","2110","2190","2250","2310","2350","2380","2390","2390","2380","2360","2320","2270","2210","2130","2050","1950"},
                    {"Nov","30","8.1","9","830","890","950","1000","1050","1100","1130","1170","1190","1210","1220","1230","1230","1220","1200","1180","1150","1120","1080"},
                    {"Dec","31","4.3","7","540","590","640","690","730","780","810","840","870","890","910","920","930","930","930","920","900","880","850"}
                };

                // zuid 180 graden
                string[,] zuid = 
                { // maanddagen,gem temp,zonuren,gem instraling bij 0,5,10......85,90 graden helling)  
                    {"Jan","31","3.8","8","710","770","830","880","930","980","1020","1050","1080","1110","1120","1130","1140","1140","1130","1110","1090","1060","1030"},
                    {"Feb","29","4.3","10","1310","1420","1520","1620","1710","1790","1860","1920","1970","2010","2040","2060","2060","2050","2030","2000","1950","1900","1830"},
                    {"Mar","31","7.1","12","2700","2860","3010","3150","3270","3370","3450","3510","3560","3580","3590","3570","3540","3480","3400","3300","3190","3050","2900"},
                    {"Apr","30","11.1","15","4370","4540","4690","4820","4920","5000","5050","5070","5060","5020","4960","4860","4740","4580","4410","4210","3980","3720","3460"},
                    {"May","31","14.5","16","5040","5130","5200","5250","5270","5270","5240","5180","5100","4990","4860","4690","4510","4300","4060","3810","3540","3250","2950"},
                    {"Jun","30","17.2","17","5450","5510","5550","5560","5550","5510","5450","5360","5240","5100","4930","4740","4520","4290","4030","3740","3460","3150","2830"},
                    {"Jul","31","18.9","16","5160","5240","5290","5310","5320","5300","5250","5170","5080","4950","4800","4630","4430","4210","3970","3700","3430","3140","2830"},
                    {"Aug","31","18.8","15","4280","4410","4510","4600","4660","4700","4710","4700","4660","4590","4510","4390","4250","4090","3910","3700","3470","3230","2970"},
                    {"Sep","30","16.2","13","3110","3270","3410","3530","3640","3720","3790","3840","3860","3870","3850","3810","3750","3660","3560","3430","3290","3130","2950"},
                    {"Oct","31","12.5","11","1830","1980","2110","2240","2360","2460","2550","2620","2680","2730","2760","2770","2760","2740","2710","2650","2580","2500","2400"},
                    {"Nov","30","8.1","9","830","916","998","1070","1150","1210","1270","1320","1370","1400","1430","1450","1460","1470","1460","1450","1420","1390","1350"},
                    {"Dec","31","4.3","7","540","612","684","752","816","876","931","981","1020","1060","1090","1120","1140","1150","1150","1150","1130","1120","1090"}
                };

                // zuidwest 225 graden
                string[,] zuidwest = 
                { // maanddagen,gem temp,zonuren,gem instraling bij 0,5,10......85,90 graden helling)  
                    {"Jan","31","3.8","8","710","770","830","880","930","980","1020","1050","1080","1110","1120","1130","1140","1140","1130","1110","1090","1060","1030"},
                    {"Feb","29","4.3","10","1310","1390","1460","1530","1590","1640","1680","1720","1750","1760","1770","1770","1760","1740","1700","1660","1610","1550","1490"},
                    {"Mar","31","7.1","12","2700","2810","2920","3010","3090","3150","3200","3230","3240","3240","3220","3190","3130","3060","2980","2870","2760","2620","2480"},
                    {"Apr","30","11.1","15","4370","4490","4590","4680","4750","4800","4830","4840","4820","4780","4710","4620","4500","4360","4190","4010","3810","3590","3350"},
                    {"May","31","14.5","16","5040","5100","5150","5180","5190","5190","5160","5110","5040","4940","4820","4680","4520","4330","4130","3900","3670","3410","3150"},
                    {"Jun","30","17.2","17","5450","5490","5510","5520","5500","5470","5410","5330","5230","5110","4960","4800","4610","4390","4170","3920","3660","3380","3110"},
                    {"Jul","31","18.9","16","5160","5210","5240","5260","5250","5230","5180","5120","5030","4920","4790","4630","4450","4260","4050","3820","3570","3320","3040"},
                    {"Aug","31","18.8","15","4280","4370","4440","4490","4530","4540","4540","4510","4470","4400","4310","4200","4070","3920","3750","3560","3360","3140","2910"},
                    {"Sep","30","16.2","13","3110","3220","3320","3400","3470","3520","3560","3570","3570","3560","3520","3470","3390","3300","3190","3070","2930","2780","2610"},
                    {"Oct","31","12.5","11","1830","1930","2030","2120","2190","2260","2310","2350","2380","2400","2400","2390","2370","2330","2280","2220","2140","2060","1960"},
                    {"Nov","30","8.1","9","830","890","950","1000","1050","1100","1130","1170","1190","1210","1220","1230","1230","1220","1200","1180","1150","1120","1080"},
                    {"Dec","31","4.3","7","540","590","640","690","730","780","810","840","870","890","910","920","930","930","930","920","900","880","850"}
                };


                // west 270
                string[,] west = 
                { // maanddagen,gem temp,zonuren,gem instraling bij 0,5,10......85,90 graden helling)  
                    {"Jan","31","3.8","8","683.870967741935","683.870967741935","683.870967741935","680.645161290323","680.645161290323","680.645161290323","677.41935483871","670.967741935484","664.516129032258","651.612903225806","641.935483870968","625.806451612903","609.677419354839","590.322580645161","567.741935483871","541.935483870968","519.354838709677","490.322580645161","464.516129032258"},
                    {"Feb","29","4.3","10","1196.55172413793","1196.55172413793","1193.10344827586","1189.65517241379","1189.65517241379","1186.20689655172","1175.86206896552","1165.51724137931","1151.72413793103","1134.48275862069","1110.34482758621","1082.75862068966","1051.72413793103","1017.24137931034","975.862068965517","937.931034482759","889.655172413793","844.827586206897","796.551724137931"},
                    {"Mar","31","7.1","12","2622.58064516129","2616.12903225806","2609.67741935484","2596.77419354839","2583.87096774194","2561.29032258065","2541.93548387097","2509.67741935484","2470.96774193548","2425.8064516129","2370.96774193548","2306.45161290323","2232.25806451613","2151.61290322581","2061.29032258064","1964.51612903226","1867.74193548387","1758.06451612903","1645.16129032258"},
                    {"Apr","30","11.1","15","4300","4300","4300","4266.66666666667","4233.33333333333","4200","4166.66666666667","4100","4033.33333333333","3966.66666666667","3866.66666666667","3766.66666666667","3666.66666666667","3533.33333333333","3366.66666666667","3216.66666666667","3046.66666666667","2870","2683.33333333333"},
                    {"May","31","14.5","16","4935.48387096774","4935.48387096774","4903.22580645161","4870.96774193548","4838.70967741936","4774.1935483871","4709.67741935484","4645.16129032258","4548.38709677419","4451.61290322581","4322.58064516129","4193.54838709677","4032.25806451613","3870.96774193548","3677.41935483871","3516.12903225806","3290.32258064516","3093.54838709677","2880.64516129032"},
                    {"Jun","30","17.2","17","5333.33333333333","5300","5300","5233.33333333333","5200","5100","5033.33333333333","4933.33333333333","4833.33333333333","4700","4566.66666666667","4433.33333333333","4233.33333333333","4066.66666666667","3866.66666666667","3666.66666666667","3433.33333333333","3213.33333333333","2986.66666666667"},
                    {"Jul","31","18.9","16","5064.51612903226","5032.25806451613","5032.25806451613","4967.74193548387","4935.48387096774","4870.96774193548","4774.1935483871","4709.67741935484","4580.64516129032","4483.87096774193","4354.83870967742","4193.54838709677","4032.25806451613","3870.96774193548","3677.41935483871","3483.87096774194","3258.06451612903","3054.83870967742","2838.70967741936"},
                    {"Aug","31","18.8","15","4225.8064516129","4193.54838709677","4193.54838709677","4161.29032258064","4096.77419354839","4064.51612903226","4000","3935.48387096774","3838.70967741935","3741.93548387097","3645.16129032258","3548.38709677419","3419.35483870968","3258.06451612903","3106.45161290323","2945.16129032258","2774.1935483871","2600","2416.12903225806"},
                    {"Sep","30","16.2","13","3016.66666666667","3010","2996.66666666667","2976.66666666667","2956.66666666667","2930","2896.66666666667","2853.33333333333","2806.66666666667","2746.66666666667","2680","2600","2513.33333333333","2416.66666666667","2313.33333333333","2200","2080","1956.66666666667","1826.66666666667"},
                    {"Oct","31","12.5","11","1758.06451612903","1754.83870967742","1748.38709677419","1741.93548387097","1735.48387096774","1722.58064516129","1709.67741935484","1690.32258064516","1664.51612903226","1635.48387096774","1596.77419354839","1554.83870967742","1506.45161290323","1451.61290322581","1396.77419354839","1332.25806451613","1261.29032258065","1196.77419354839","1119.35483870968"},
                    {"Nov","30","8.1","9","796.666666666667","793.333333333333","793.333333333333","790","790","786.666666666667","783.333333333333","776.666666666667","766.666666666667","753.333333333333","736.666666666667","720","700","673.333333333333","650","620","593.333333333333","560","526.666666666667"},
                    {"Dec","31","4.3","7","519.354838709677","516.129032258065","516.129032258065","516.129032258065","516.129032258065","516.129032258065","512.903225806452","509.677419354839","503.225806451613","496.774193548387","487.096774193548","477.41935483871","461.290322580645","448.387096774194","432.258064516129","412.903225806452","396.774193548387","374.193548387097","354.838709677419"},
                };
               
                
                // get a temporary culture (clone) to modify
                var ci = CultureInfo.InvariantCulture.Clone() as CultureInfo;
                ci.NumberFormat.NumberDecimalSeparator = ".";
                
                //return Convert.ToDouble(decimal.Parse( mTable[Month - 1, Param - 1],ci));

                double tmp = 0;
                tmp = Helling / 5;
                tmp = Math.Round(tmp);
                Int16 HellingIdx = Convert.ToInt16(tmp + 4) ;
                double interpolated;
                
                switch (Param) // case 1,2 and 3 have same values in oos-zuid-west tables
                {
                    case 2: //days per month
                        return Convert.ToDouble(decimal.Parse(zuid[Month - 1, Param - 1], ci));
                        break;
                    case 3: //avg temp
                        return Convert.ToDouble(decimal.Parse(zuid[Month - 1, Param - 1], ci));
                       break;
                    case 4: //solar hours
                        return Convert.ToDouble(decimal.Parse(zuid[Month - 1, Param - 1], ci));
                        break;
                        
                    case 5: // radiation               
                        switch(Azimut)
                        {
                            case "O":
                                return Convert.ToDouble(decimal.Parse(oost[Month - 1, HellingIdx], ci));
                               break;
                            case "OZO":
                               interpolated = (Convert.ToDouble(decimal.Parse(oost[Month - 1, HellingIdx], ci)) + Convert.ToDouble(decimal.Parse(zuidoost[Month - 1, HellingIdx], ci))) / 2;
                               return interpolated;
                               break;
                            case "ZO":
                               return Convert.ToDouble(decimal.Parse(zuidoost[Month - 1, HellingIdx], ci));
                               break;
                            case "ZZO":
                               interpolated = (Convert.ToDouble(decimal.Parse(zuidoost[Month - 1, HellingIdx], ci)) + Convert.ToDouble(decimal.Parse(zuid[Month - 1, HellingIdx], ci))) / 2;
                               return interpolated;
                               break;
                            case "Z":
                               return Convert.ToDouble(decimal.Parse(zuid[Month - 1, HellingIdx], ci));
                               break;
                            case "ZZW":
                               interpolated = (Convert.ToDouble(decimal.Parse(zuid[Month - 1, HellingIdx], ci)) + Convert.ToDouble(decimal.Parse(zuidwest[Month - 1, HellingIdx], ci))) / 2;
                               return interpolated;
                               break;
                            case "ZW":
                               return Convert.ToDouble(decimal.Parse(zuidwest[Month - 1, HellingIdx], ci));
                               break;
                            case "WZW":
                               interpolated = (Convert.ToDouble(decimal.Parse(zuidwest[Month - 1, HellingIdx], ci)) + Convert.ToDouble(decimal.Parse(west[Month - 1, HellingIdx], ci))) / 2;
                               return interpolated;
                               break;
                            case "W":
                               return Convert.ToDouble(decimal.Parse(west[Month - 1, HellingIdx], ci));
                               break;

                            default:
                               return 0;
                               break;
                        }
                        break;

                
                }

                return 0;
 
            }
  
            
            
            public Double GetCapacityInfo(int liters) // bereken hoeveel kwh nodig voor opwarmen hoeveelheid liters/dag
            {
                int gradenopwarming = 40-8; // koud water van 8 graden naar 40 graden
                int sw_water = 4186; // sw in J/(kg·K)
                
              return  (liters * gradenopwarming * sw_water)/3600/1000;
            }
            
            public double BoilerLoss(double liters) // bereken warmteverlies
            {
                double wattloss=0;

                Int16[,] losstable = new Int16[10, 2] {
                    {150,28},
                    {200,31},
                    {300,36},
                    {400,40},
                    {500,43},
                    {800,51},
                    {1000,55},
                    {1500,63},                   
                    {2000,70},
                    {20000,200}
                };

                int idx = 0;
                foreach (var i in losstable)
                {
                    if (losstable[idx, 0] >= liters)
                    {
                        wattloss = losstable[idx, 1];
                        break;
                       
                    }

                    idx += 1;
                       
                }

                return wattloss;
              
              }
                
                
      }


   </div>
              
 
















