@model Nop.Web.Areas.Admin.Models.Catalog.ProductSearchModel
@using FoxNetSoft.Plugin.Misc.ModularProducts.Models.Admin
@using Nop.Web.Framework.Extensions
@{
    Layout = "_AdminLayout";
    //page title
    ViewBag.Title = @T("Admin.FoxNetSoft.Plugin.Misc.ModularProducts.Products.Manage").Text;

    Html.SetActiveMenuItemSystemName("FoxNetSoft.ModularProducts.List");
}
<nop-antiforgery-token />
<div class="content-header clearfix">
    <h1 class="pull-left">
        @T("Admin.FoxNetSoft.Plugin.Misc.ModularProducts.Products.Manage")
    </h1>
</div>
<div class="content">
    <div class="form-horizontal">
        <div class="panel-group">
            <div class="panel panel-default panel-search">
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="col-md-4">
                                    <nop-label asp-for="SearchProductName" />
                                </div>
                                <div class="col-md-8">
                                    <nop-editor asp-for="SearchProductName" />
                                </div>
                            </div>
                            <div class="form-group" @(Model.AvailableCategories.SelectionIsNotPossible() ? Html.Raw("style=\"display:none\"") : null)>
                                <div class="col-sm-4">
                                    <nop-label asp-for="SearchCategoryId" />
                                </div>
                                <div class="col-sm-8">
                                    <nop-select asp-for="SearchCategoryId" asp-items="Model.AvailableCategories" />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-4">
                                    <nop-label asp-for="SearchIncludeSubCategories" />
                                </div>
                                <div class="col-md-8">
                                    <nop-editor asp-for="SearchIncludeSubCategories" />
                                </div>
                            </div>
                            <div class="form-group" @(Model.AvailableManufacturers.SelectionIsNotPossible() ? Html.Raw("style=\"display:none\"") : null)>
                                <div class="col-sm-4">
                                    <nop-label asp-for="SearchManufacturerId" />
                                </div>
                                <div class="col-sm-8">
                                    <nop-select asp-for="SearchManufacturerId" asp-items="Model.AvailableManufacturers" />
                                </div>
                            </div>
                            @*<div class="form-group" @(Model.AvailableStores.SelectionIsNotPossible() ? Html.Raw("style=\"display:none\"") : null)>
                                <div class="col-sm-4">
                                    <nop-label asp-for="SearchStoreId" />
                                </div>
                                <div class="col-sm-8">
                                    <nop-select asp-for="SearchStoreId" asp-items="Model.AvailableStores" />
                                </div>
                            </div>*@
                            <div class="form-group" @((Model.IsLoggedInAsVendor && Model.AvailableVendors.SelectionIsNotPossible()) ? Html.Raw("style='display: none;'") : null)>
                                <div class="col-md-4">
                                    <nop-label asp-for="SearchVendorId" />
                                </div>
                                <div class="col-md-8">
                                    <nop-select asp-for="SearchVendorId" asp-items="Model.AvailableVendors" />
                                </div>
                            </div>
                            <div class="form-group" @(Model.AvailableWarehouses.SelectionIsNotPossible() ? Html.Raw("style=\"display:none\"") : null)>
                                <div class="col-md-4">
                                    <nop-label asp-for="SearchWarehouseId" />
                                </div>
                                <div class="col-md-8">
                                    <nop-select asp-for="SearchWarehouseId" asp-items="Model.AvailableWarehouses" />
                                </div>
                            </div>
                            @*<div class="form-group">
                                <div class="col-md-4">
                                    <nop-label asp-for="SearchProductTypeId" />
                                </div>
                                <div class="col-md-8">
                                    <nop-select asp-for="SearchProductTypeId" asp-items="Model.AvailableProductTypes" />
                                </div>
                            </div>*@
                            <div class="form-group">
                                <div class="col-md-8 col-md-offset-4">
                                    <button type="button" id="btnSearch" class="btn btn-primary btn-search"><i class="fa fa-search"></i>@T("Admin.Common.Search")</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-body">
                    @await Html.PartialAsync("Table", new DataTablesModel
                    {
                        Name = "products-grid",
                        UrlRead = new DataUrl("ProductList", "ModularProductsAdmin", null),
                        SearchButtonId = "btnSearch",
                        Length = Model.PageSize,
                        LengthMenu = Model.AvailablePageSizes,
                        Filters = new List<FilterParameter>
                        {
                            new FilterParameter(nameof(Model.SearchProductName)),
                            new FilterParameter(nameof(Model.SearchCategoryId)),
                            new FilterParameter(nameof(Model.SearchIncludeSubCategories), typeof(bool)),
                            new FilterParameter(nameof(Model.SearchManufacturerId)),
                            //new FilterParameter(nameof(Model.SearchStoreId)),
                            new FilterParameter(nameof(Model.SearchWarehouseId)),
                            new FilterParameter(nameof(Model.SearchVendorId)),
                            //new FilterParameter(nameof(Model.SearchProductTypeId)),
                            new FilterParameter(nameof(Model.SearchPublishedId))
                        },
                        ColumnCollection = new List<ColumnProperty>
                        {
                            new ColumnProperty(nameof(ModularProductModel.Published))
                            {
                                Title = T("Admin.Catalog.Products.Fields.Published").Text,
                                Width = "100",
                                ClassName = NopColumnClassDefaults.CenterAll,
                                Render = new RenderBoolean()
                            },
                            new ColumnProperty(nameof(ModularProductModel.PictureThumbnailUrl))
                            {
                                Title = T("Admin.Catalog.Products.Fields.PictureThumbnailUrl").Text,
                                Width = "100",
                                Render = new RenderPicture()
                            },
                            new ColumnProperty(nameof(ModularProductModel.Name))
                            {
                                Title = T("Admin.Catalog.Products.Fields.Name").Text,
                                ClassName = NopColumnClassDefaults.Button,
                                Render = new RenderCustom("renderColumnNameModularProductName")
                            },
                            new ColumnProperty(nameof(ModularProductModel.ProductTemplate))
                            {
                                Title = T("Admin.Catalog.Products.Fields.ProductTemplate").Text,
                                Width = "200"
                            },
                            new ColumnProperty(nameof(ModularProductModel.Id))
                            {
                                Title = T("Admin.Common.Edit").Text,
                                Width = "100",
                                ClassName =  NopColumnClassDefaults.Button,
                                Render = new RenderButtonEdit(new DataUrl("Edit"))
                            }
                        }
                    })
                    <script>
                        function renderColumnNameModularProductName(data, type, row, meta) {
                    return '<a href="@Url.Content("~/Admin/Product/Edit/")'+ row.Id + '">' + row.Name +'</a>';
                }
                    </script>
                </div>
            </div>
        </div>
    </div>
</div>
